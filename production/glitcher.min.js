/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*!
  * Reqwest! A general purpose XHR connection manager
  * license MIT (c) Dustin Diaz 2015
  * https://github.com/ded/reqwest
  */

/*!
    localForage -- Offline Storage, Improved
    Version 1.3.1
    https://mozilla.github.io/localForage
    (c) 2013-2015 Mozilla, Apache License 2.0
*/

/*
	 * Includes code from:
	 *
	 * base64-arraybuffer
	 * https://github.com/niklasvh/base64-arraybuffer
	 *
	 * Copyright (c) 2012 Niklas von Hertzen
	 * Licensed under the MIT license.
	 */

/*
 * JavaScript MD5 1.0.1
 * https://github.com/blueimp/JavaScript-MD5
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 * 
 * Based on
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */

!function(){var requirejs,require,define;!function(e){function t(e,t){return v.call(e,t)}function n(e,t){var n,r,i,a,o,s,l,u,c,d,f,h=t&&t.split("/"),p=g.map,m=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),o=e.length-1,g.nodeIdCompat&&b.test(e[o])&&(e[o]=e[o].replace(b,"")),e=h.slice(0,h.length-1).concat(e),c=0;c<e.length;c+=1)if("."===(f=e[c]))e.splice(c,1),c-=1;else if(".."===f){if(1===c&&(".."===e[2]||".."===e[0]))break;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||m)&&p){for(n=e.split("/"),c=n.length;c>0;c-=1){if(r=n.slice(0,c).join("/"),h)for(d=h.length;d>0;d-=1)if((i=p[h.slice(0,d).join("/")])&&(i=i[r])){a=i,s=c;break}if(a)break;!l&&m&&m[r]&&(l=m[r],u=c)}!a&&l&&(a=l,s=u),a&&(n.splice(0,s,a),e=n.join("/"))}return e}function r(t,n){return function(){var r=w.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),c.apply(e,r.concat([t,n]))}}function i(e){return function(t){return n(t,e)}}function a(e){return function(t){h[e]=t}}function o(n){if(t(p,n)){var r=p[n];delete p[n],m[n]=!0,u.apply(e,r)}if(!t(h,n)&&!t(m,n))throw new Error("No "+n);return h[n]}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function l(e){return function(){return g&&g.config&&g.config[e]||{}}}var u,c,d,f,h={},p={},g={},m={},v=Object.prototype.hasOwnProperty,w=[].slice,b=/\.js$/;d=function(e,t){var r,a=s(e),l=a[0];return e=a[1],l&&(l=n(l,t),r=o(l)),l?e=r&&r.normalize?r.normalize(e,i(t)):n(e,t):(e=n(e,t),a=s(e),l=a[0],e=a[1],l&&(r=o(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:r}},f={require:function(e){return r(e)},exports:function(e){var t=h[e];return void 0!==t?t:h[e]={}},module:function(e){return{id:e,uri:"",exports:h[e],config:l(e)}}},u=function(n,i,s,l){var u,c,g,v,w,b,y=[],L=typeof s;if(l=l||n,"undefined"===L||"function"===L){for(i=!i.length&&s.length?["require","exports","module"]:i,w=0;w<i.length;w+=1)if(v=d(i[w],l),"require"===(c=v.f))y[w]=f.require(n);else if("exports"===c)y[w]=f.exports(n),b=!0;else if("module"===c)u=y[w]=f.module(n);else if(t(h,c)||t(p,c)||t(m,c))y[w]=o(c);else{if(!v.p)throw new Error(n+" missing "+c);v.p.load(v.n,r(l,!0),a(c),{}),y[w]=h[c]}g=s?s.apply(h[n],y):void 0,n&&(u&&u.exports!==e&&u.exports!==h[n]?h[n]=u.exports:g===e&&b||(h[n]=g))}else n&&(h[n]=s)},requirejs=require=c=function(t,n,r,i,a){if("string"==typeof t)return f[t]?f[t](n):o(d(t,n).f);if(!t.splice){if(g=t,g.deps&&c(g.deps,g.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=i,i=a),i?u(e,t,n,r):setTimeout(function(){u(e,t,n,r)},4),c},c.config=function(e){return c(e)},requirejs._defined=h,define=function(e,n,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(r=n,n=[]),t(h,e)||t(p,e)||(p[e]=[e,n,r])},define.amd={jQuery:!0}}(),define("lib/almond",function(){}),define("config",[],function(){return{keys:{imgur:"a4c24380d884932",storage:"glitch-items",settings:"settings",language:"language"},defaultControlParams:{amount:{min:0,max:99,value:24},seed:{min:0,max:100,value:53},iterations:{min:0,max:100,value:21},quality:{min:1,max:99,value:46}},defaultImage:{name:"AbrahamLincoln",path:"images/lincoln.jpg"},workers:{glitch:"glitchworker.min.js",storage:"storageworker.min.js",settings:"settingsworker.min.js"},language:{dir:"lang",preset:"en-us",debug:-1!==window.location.hash.indexOf("languagedebug")},settings:{canZoomWithPointer:{value:!0},resizeUploadedImages:{value:!0},language:{value:"en-us",options:["en-us","en-gb","de-de","ru-ru"]}},localForage:{name:"glitchtool",storeName:"keyvaluepairs"},origin:location.protocol+"//"+location.host+(""!==location.port?":"+location.port:""),share:{appURL:"https://snorpey.github.io/jpg-glitch",sharer:{facebook:"https://www.facebook.com/sharer/sharer.php",twitter:"https://twitter.com/intent/tweet",reddit:"https://www.reddit.com/submit",pinterest:"https://pinterest.com/pin/create/button/",vkontakte:"http://vk.com/share.php"}}}}),define("util/string",[],function(){function e(e){e&&Array.isArray(e)&&(e=e.join(" "));var t=e.split(/(-|\s|_)/gim),n="";return t.forEach(function(e,t){e.match(/(-|\s|_)/gim)||(t>0&&e.length>1?n+=e.charAt(0).toUpperCase()+e.slice(1):n+=e)}),n}function t(e,t){return r(n(e,t.links),t.autop)}function n(e,t){e=e||"";var n=[],r="";t&&(t.newTab&&n.push('target="_blank"'),t.cssClasses&&n.push('class="'+cssClasses+'"')),r=n.length?" "+n.join(" "):"";var i='<a href="$2"'+r+">$1</a>";return e.replace(/\\n/gm,"\n").replace(/\[(.*?)\]\((.+?)\)/g,i)}function r(e,t){e=e||"";var n=t&&t.tag?t.tag:"p",r=t&&t.linebreak?"<"+t.linebreak+">":"<br />",i="<"+n+">",a="</"+n+">";return t&&t.cssClasses&&"string"==typeof t.cssClasses&&(i="<"+n+' class="'+t.cssClasses+'">'),i+e.replace(/\n{2}/g,"&nbsp;"+a+i).replace(/\n/g,"&nbsp;"+r)+a}function i(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var a=t?t+"["+r+"]":r,o=e[r];n.push("object"==typeof o?i(o,a):encodeURIComponent(a)+"="+encodeURIComponent(o))}return n.join("&")}return{toCamelCase:e,autop:r,markdownToHtml:t,markdownLinksToHtml:n,objToQueryStr:i}}),define("util/browser",["util/string"],function(e){function t(e){return void 0!==a[e]?a[e]:(a[e]=!!o[e]&&o[e](),a[e])}function n(t,n){var a=r(t,n);if(!a)for(var o=0,s=i.length;o<s&&!a;o++)a=r(t,e.toCamelCase(i[o]+"-"+n));return a}function r(e,t){return e[t]}var i=["webkit","moz","ms","o"],a={},o={getusermedia:function(){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia},fullscreen:function(){return!(!n(document,"fullScreenEnabled")&&!n(document,"fullscreenEnabled"))},browserdb:function(){return n(window,"indexedDB")||n(window,"openDatabase")},browserstorage:function(){return t("browserdb")||n(window,"localStorage")},draganddrop:function(){return"draggable"in document.createElement("span")},touch:function(){return!!("ontouchstart"in window)},webworker:function(){return!!("Worker"in window)},promise:function(){return!!("Promise"in window)},localforage:function(){return t("promise")&&t("browserstorage")},safari:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}};return{getFeature:n,test:t}}),define("util/dom",[],function(){function e(e,t){e.style.transform=e.style.webkitTransform=e.style.msTransform=t}function t(e,t){for(var n=t.parentNode;null!=n;){if(n==e)return!0;n=n.parentNode}return!1}function n(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}return{setTransform:e,isDescendant:t,isElement:n}}),define("util/object",[],function(){function e(e,t){if("string"==typeof e){e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var n=e.split("."),r=0,i=n.length;r<i;++r){var a=n[r];if(!(a in t))return;t=t[a]}}return t}function t(e){return JSON.parse(JSON.stringify(e))}function n(e,t){return JSON.stringify(e)===JSON.stringify(t)}function r(e,n){e=t(e),n=t(n);for(var i in n)try{"object"==typeof n[i]?e[i]=r(e[i],n[i]):void 0===e[i]&&void 0!==n[i]&&(e[i]=n[i])}catch(t){e[i]=n[i]}return e}return{getObjectByString:e,getCopy:t,merge:r,isEqual:n}}),define("util/addpublishers",["util/object"],function(e){function t(){function t(e){var t=[],n=Object.keys(u);"string"==typeof e&&(t=t.concat(e.split(" "))),Array.isArray(e)&&(t=t.concat(e)),t=t.filter(function(e){return-1===n.indexOf(e)&&-1===s.indexOf(e)}),s=s.concat(t)}function n(t,n){if("string"==typeof t&&-1!==t.indexOf(".")){var r=t.split("."),t=r.pop(),i=e.getObjectByString(r.join("."),u);i&&"function"==typeof i.on&&i.on(t,n)}else a(t)&&"function"==typeof n&&o[t].push(n);return u}function r(e,t){if("string"==typeof e&&"function"==typeof t&&o[e])for(var n=o[e].length;n>=0;n--)o[e][n]===t&&o[e].splice(n,1);return u}function i(e){var t=Array.prototype.slice.call(arguments).slice(1);return Array.isArray(o[e])&&o[e].forEach(function(e){e.apply(e,t)}),u}function a(e){return!s||s.indexOf(e)>-1}var o={},s=[],l=Array.prototype.slice.call(arguments),u=l.shift();return u&&l.length&&l.forEach(t),s.forEach(function(e){u[e]||(u[e]={}),u[e].dispatch=function(){i.apply(i,[e].concat(Array.prototype.slice.call(arguments)))},o[e]||(o[e]=[]),o[e].dispatch=function(){i.apply(i,[e].concat(Array.prototype.slice.call(arguments)))}}),o.dispatch=i,u.on=n,u.off=r,o}return t}),function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define("lib/reqwest",n):t.reqwest=n()}(0,this,function(){function succeed(e){var t=protocolRe.exec(e.url);return t=t&&t[1]||context.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,n){return function(){return e._aborted?n(e.request):e._timedOut?n(e.request,"Request is aborted: timeout"):void(e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):n(e.request)))}}function setHeaders(e,t){var n,r=t.headers||{};r.Accept=r.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var i="function"==typeof FormData&&t.data instanceof FormData;t.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||i||(r[contentType]=t.contentType||defaultHeaders.contentType);for(n in r)r.hasOwnProperty(n)&&"setRequestHeader"in e&&e.setRequestHeader(n,r[n])}function setCredentials(e,t){void 0!==t.withCredentials&&void 0!==e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var i=uniqid++,a=e.jsonpCallback||"callback",o=e.jsonpCallbackName||reqwest.getcallbackPrefix(i),s=new RegExp("((^|\\?|&)"+a+")=([^&]+)"),l=r.match(s),u=doc.createElement("script"),c=0,d=-1!==navigator.userAgent.indexOf("MSIE 10.0");return l?"?"===l[3]?r=r.replace(s,"$1="+o):o=l[3]:r=urlappend(r,a+"="+o),context[o]=generalCallback,u.type="text/javascript",u.src=r,u.async=!0,void 0===u.onreadystatechange||d||(u.htmlFor=u.id="_reqwest_"+i),u.onload=u.onreadystatechange=function(){if(u[readyState]&&"complete"!==u[readyState]&&"loaded"!==u[readyState]||c)return!1;u.onload=u.onreadystatechange=null,u.onclick&&u.onclick(),t(lastValue),lastValue=void 0,head.removeChild(u),c=1},head.appendChild(u),{abort:function(){u.onload=u.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(u),c=1}}}function getRequest(e,t){var n,r=this.o,i=(r.method||"GET").toUpperCase(),a="string"==typeof r?r:r.url,o=!1!==r.processData&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null,s=!1;return"jsonp"!=r.type&&"GET"!=i||!o||(a=urlappend(a,o),o=null),"jsonp"==r.type?handleJsonp(r,e,t,a):(n=r.xhr&&r.xhr(r)||xhr(r),n.open(i,a,!1!==r.async),setHeaders(n,r),setCredentials(n,r),context[xDomainRequest]&&n instanceof context[xDomainRequest]?(n.onload=e,n.onerror=t,n.onprogress=function(){},s=!0):n.onreadystatechange=handleReadyState(this,e,t),r.before&&r.before(n),s?setTimeout(function(){n.send(o)},200):n.send(o),n)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){if(null!==e)return e.match("json")?"json":e.match("javascript")?"js":e.match("text")?"html":e.match("xml")?"xml":void 0}function init(o,fn){function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=context.JSON?context.JSON.parse(r):eval("("+r+")")}catch(e){return error(resp,"Could not parse JSON in response",e)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(e,t,n){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,n);complete(e)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var n,r,i,a,o=e.name,s=e.tagName.toLowerCase(),l=function(e){e&&!e.disabled&&t(o,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))};if(!e.disabled&&o)switch(s){case"input":/reset|button|image|file/i.test(e.type)||(n=/checkbox/i.test(e.type),r=/radio/i.test(e.type),i=e.value,(!(n||r)||e.checked)&&t(o,normalize(n&&""===i?"on":i)));break;case"textarea":t(o,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())l(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(a=0;e.length&&a<e.length;a++)e.options[a].selected&&l(e.options[a])}}function eachFormElement(){var e,t,n=this;for(t=0;t<arguments.length;t++)e=arguments[t],/input|select|textarea/i.test(e.tagName)&&serial(e,n),function(e,t){var r,i,a;for(r=0;r<t.length;r++)for(a=e[byTag](t[r]),i=0;i<a.length;i++)serial(a[i],n)}(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}function buildParams(e,t,n,r){var i,a,o,s=/\[\]$/;if(isArray(t))for(a=0;t&&a<t.length;a++)o=t[a],n||s.test(e)?r(e,o):buildParams(e+"["+("object"==typeof o?a:"")+"]",o,n,r);else if(t&&"[object Object]"===t.toString())for(i in t)buildParams(e+"["+i+"]",t[i],n,r);else r(e,t)}var context=this;if("window"in context)var doc=document,byTag="getElementsByTagName",head=doc[byTag]("head")[0];else{var XHR2;try{var xhr2="xhr2";XHR2=require(xhr2)}catch(e){throw new Error("Peer dependency `xhr2` required! Please npm install xhr2")}}var httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(!0===e.crossOrigin){var t=context[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(context[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return context[xmlHttpRequest]?new XMLHttpRequest:XHR2?new XHR2:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},catch:function(e){return this.fail(e)}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(0===arguments.length)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),t="map"==e?serializeHash:"array"==e?reqwest.serializeArray:serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e,t){var n,r,i=t||!1,a=[],o=encodeURIComponent,s=function(e,t){t="function"==typeof t?t():null==t?"":t,a[a.length]=o(e)+"="+o(t)};if(isArray(e))for(r=0;e&&r<e.length;r++)s(e[r].name,e[r].value);else for(n in e)e.hasOwnProperty(n)&&buildParams(n,e[n],i,s);return a.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest}),"Promise"in("undefined"!=typeof window?window:self)&&function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("lib/localforage.nopromises",[],t):"object"==typeof exports?exports.localforage=t():e.localforage=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0,function(){function e(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function i(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(f(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}function a(e){for(var t in s)if(s.hasOwnProperty(t)&&s[t]===e)return!0;return!1}var o={},s={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},l=[s.INDEXEDDB,s.WEBSQL,s.LOCALSTORAGE],u=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],c={description:"",driver:l.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},d=function(e){var t=t||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB,n={};return n[s.WEBSQL]=!!e.openDatabase,n[s.INDEXEDDB]=!!function(){if(void 0!==e.openDatabase&&e.navigator&&e.navigator.userAgent&&/Safari/.test(e.navigator.userAgent)&&!/Chrome/.test(e.navigator.userAgent))return!1;try{return t&&"function"==typeof t.open&&void 0!==e.IDBKeyRange}catch(e){return!1}}(),n[s.LOCALSTORAGE]=!!function(){try{return e.localStorage&&"setItem"in e.localStorage&&e.localStorage.setItem}catch(e){return!1}}(),n}(this),f=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},h=function(){function t(e){r(this,t),this.INDEXEDDB=s.INDEXEDDB,this.LOCALSTORAGE=s.LOCALSTORAGE,this.WEBSQL=s.WEBSQL,this._defaultConfig=i({},c),this._config=i({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return t.prototype.config=function(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e)"storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),this._config[t]=e[t];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},t.prototype.defineDriver=function(e,t,n){var r=new Promise(function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),s=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(i);if(a(e._driver))return void n(s);for(var l=u.concat("_initStorage"),c=0;c<l.length;c++){var f=l[c];if(!f||!e[f]||"function"!=typeof e[f])return void n(i)}var h=Promise.resolve(!0);"_support"in e&&(h=e._support&&"function"==typeof e._support?e._support():Promise.resolve(!!e._support)),h.then(function(n){d[r]=n,o[r]=e,t()},n)}catch(e){n(e)}});return r.then(t,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(e,t,r){var i=this,s=function(){if(a(e))switch(e){case i.INDEXEDDB:return new Promise(function(e,t){e(n(1))});case i.LOCALSTORAGE:return new Promise(function(e,t){e(n(2))});case i.WEBSQL:return new Promise(function(e,t){e(n(4))})}else if(o[e])return Promise.resolve(o[e]);return Promise.reject(new Error("Driver not found."))}();return s.then(t,r),s},t.prototype.getSerializer=function(e){var t=new Promise(function(e,t){e(n(3))});return e&&"function"==typeof e&&t.then(function(t){e(t)}),t},t.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return n.then(e,e),n},t.prototype.setDriver=function(e,t,n){function r(){a._config.driver=a.driver()}function i(e){return function(){function t(){for(;n<e.length;){var i=e[n];return n++,a._dbInfo=null,a._ready=null,a.getDriver(i).then(function(e){return a._extend(e),r(),a._ready=a._initStorage(a._config),a._ready}).catch(t)}r();var o=new Error("No available storage method found.");return a._driverSet=Promise.reject(o),a._driverSet}var n=0;return t()}}var a=this;f(e)||(e=[e]);var o=this._getSupportedDrivers(e),s=null!==this._driverSet?this._driverSet.catch(function(){return Promise.resolve()}):Promise.resolve();return this._driverSet=s.then(function(){var e=o[0];return a._dbInfo=null,a._ready=null,a.getDriver(e).then(function(e){a._driver=e._driver,r(),a._wrapLibraryMethodsWithReady(),a._initDriver=i(o)})}).catch(function(){r();var e=new Error("No available storage method found.");return a._driverSet=Promise.reject(e),a._driverSet}),this._driverSet.then(t,n),this._driverSet},t.prototype.supports=function(e){return!!d[e]},t.prototype._extend=function(e){i(this,e)},t.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0;t<u.length;t++)e(this,u[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),p=new h;t.default=p}.call("undefined"!=typeof window?window:self),e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,function(){function e(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(a){if("TypeError"!==a.name)throw a;for(var n=x.BlobBuilder||x.MSBlobBuilder||x.MozBlobBuilder||x.WebKitBlobBuilder,r=new n,i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(t.type)}}function n(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function r(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.withCredentials=!0,r.responseType="arraybuffer",r.onreadystatechange=function(){if(4===r.readyState)return 200===r.status?t({response:r.response,type:r.getResponseHeader("Content-Type")}):void n({status:r.status,response:r.response})},r.send()})}function i(t){return new Promise(function(n,i){var a=e([""],{type:"image/png"}),o=t.transaction([A],"readwrite");o.objectStore(A).put(a,"key"),o.oncomplete=function(){var e=t.transaction([A],"readwrite"),a=e.objectStore(A).get("key");a.onerror=i,a.onsuccess=function(e){var t=e.target.result,i=URL.createObjectURL(t);r(i).then(function(e){n(!(!e||"image/png"!==e.type))},function(){n(!1)}).then(function(){URL.revokeObjectURL(i)})}}}).catch(function(){return!1})}function a(e){return"boolean"==typeof S?Promise.resolve(S):i(e).then(function(e){return S=e})}function o(e){return new Promise(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function s(t){return e([n(atob(t.data))],{type:t.type})}function l(e){return e&&e.__local_forage_encoded_blob}function u(e){function t(){return Promise.resolve()}var n=this,r={db:null};if(e)for(var i in e)r[i]=e[i];I||(I={});var a=I[r.name];a||(a={forages:[],db:null},I[r.name]=a),a.forages.push(this);for(var o=[],s=0;s<a.forages.length;s++){var l=a.forages[s];l!==this&&o.push(l.ready().catch(t))}var u=a.forages.slice(0);return Promise.all(o).then(function(){return r.db=a.db,c(r)}).then(function(e){return r.db=e,h(r,n._defaultConfig.version)?d(r):e}).then(function(e){r.db=a.db=e,n._dbInfo=r;for(var t=0;t<u.length;t++){var i=u[t];i!==n&&(i._dbInfo.db=r.db,i._dbInfo.version=r.version)}})}function c(e){return f(e,!1)}function d(e){return f(e,!0)}function f(e,t){return new Promise(function(n,r){if(e.db){if(!t)return n(e.db);e.db.close()}var i=[e.name];t&&i.push(e.version);var a=k.open.apply(k,i);t&&(a.onupgradeneeded=function(t){var n=a.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(A)}catch(n){if("ConstraintError"!==n.name)throw n;x.console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),a.onerror=function(){r(a.error)},a.onsuccess=function(){n(a.result)}})}function h(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&x.console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function p(e,t){var n=this;"string"!=typeof e&&(x.console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new Promise(function(t,r){n.ready().then(function(){var i=n._dbInfo,a=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),o=a.get(e);o.onsuccess=function(){var e=o.result;void 0===e&&(e=null),l(e)&&(e=s(e)),t(e)},o.onerror=function(){r(o.error)}}).catch(r)});return E(r,t),r}function g(e,t){var n=this,r=new Promise(function(t,r){n.ready().then(function(){var i=n._dbInfo,a=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),o=a.openCursor(),u=1;o.onsuccess=function(){var n=o.result;if(n){var r=n.value;l(r)&&(r=s(r));var i=e(r,n.key,u++);void 0!==i?t(i):n.continue()}else t()},o.onerror=function(){r(o.error)}}).catch(r)});return E(r,t),r}function m(e,t,n){var r=this;"string"!=typeof e&&(x.console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new Promise(function(n,i){var s;r.ready().then(function(){return s=r._dbInfo,t instanceof Blob?a(s.db).then(function(e){return e?t:o(t)}):t}).then(function(t){var r=s.db.transaction(s.storeName,"readwrite"),a=r.objectStore(s.storeName);null===t&&(t=void 0);var o=a.put(t,e);r.oncomplete=function(){void 0===t&&(t=null),n(t)},r.onabort=r.onerror=function(){var e=o.error?o.error:o.transaction.error;i(e)}}).catch(i)});return E(i,n),i}function v(e,t){var n=this;"string"!=typeof e&&(x.console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new Promise(function(t,r){n.ready().then(function(){var i=n._dbInfo,a=i.db.transaction(i.storeName,"readwrite"),o=a.objectStore(i.storeName),s=o.delete(e);a.oncomplete=function(){t()},a.onerror=function(){r(s.error)},a.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}).catch(r)});return E(r,t),r}function w(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readwrite"),a=i.objectStore(r.storeName),o=a.clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=o.error?o.error:o.transaction.error;n(e)}}).catch(n)});return E(n,e),n}function b(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),a=i.count();a.onsuccess=function(){e(a.result)},a.onerror=function(){n(a.error)}}).catch(n)});return E(n,e),n}function y(e,t){var n=this,r=new Promise(function(t,r){if(e<0)return void t(null);n.ready().then(function(){var i=n._dbInfo,a=i.db.transaction(i.storeName,"readonly").objectStore(i.storeName),o=!1,s=a.openCursor();s.onsuccess=function(){var n=s.result;if(!n)return void t(null);0===e?t(n.key):o?t(n.key):(o=!0,n.advance(e))},s.onerror=function(){r(s.error)}}).catch(r)});return E(r,t),r}function L(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo,i=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),a=i.openCursor(),o=[];a.onsuccess=function(){var t=a.result;if(!t)return void e(o);o.push(t.key),t.continue()},a.onerror=function(){n(a.error)}}).catch(n)});return E(n,e),n}function E(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var x=this,k=k||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(k){var S,I,A="local-forage-detect-blob-support",_={_driver:"asyncStorage",_initStorage:u,iterate:g,getItem:p,setItem:m,removeItem:v,clear:w,length:b,key:y,keys:L};t.default=_}}.call("undefined"!=typeof window?window:self),e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0,function(){function e(e){var t=this,r={};if(e)for(var i in e)r[i]=e[i];return r.keyPrefix=r.name+"/",r.storeName!==t._defaultConfig.storeName&&(r.keyPrefix+=r.storeName+"/"),t._dbInfo=r,new Promise(function(e,t){e(n(3))}).then(function(e){return r.serializer=e,Promise.resolve()})}function r(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=h.length-1;n>=0;n--){var r=h.key(n);0===r.indexOf(e)&&h.removeItem(r)}});return d(n,e),n}function i(e,t){var n=this;"string"!=typeof e&&(f.console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=n.ready().then(function(){var t=n._dbInfo,r=h.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return d(r,t),r}function a(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,a=h.length,o=1,s=0;s<a;s++){var l=h.key(s);if(0===l.indexOf(r)){var u=h.getItem(l);if(u&&(u=t.serializer.deserialize(u)),void 0!==(u=e(u,l.substring(i),o++)))return u}}});return d(r,t),r}function o(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=h.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return d(r,t),r}function s(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=h.length,r=[],i=0;i<n;i++)0===h.key(i).indexOf(e.keyPrefix)&&r.push(h.key(i).substring(e.keyPrefix.length));return r});return d(n,e),n}function l(e){var t=this,n=t.keys().then(function(e){return e.length});return d(n,e),n}function u(e,t){var n=this;"string"!=typeof e&&(f.console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=n.ready().then(function(){var t=n._dbInfo;h.removeItem(t.keyPrefix+e)});return d(r,t),r}function c(e,t,n){var r=this;"string"!=typeof e&&(f.console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new Promise(function(i,a){var o=r._dbInfo;o.serializer.serialize(t,function(t,r){if(r)a(r);else try{h.setItem(o.keyPrefix+e,t),i(n)}catch(e){
"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||a(e),a(e)}})})});return d(i,n),i}function d(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var f=this,h=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;h=this.localStorage}catch(e){return}var p={_driver:"localStorageWrapper",_initStorage:e,iterate:a,getItem:i,setItem:c,removeItem:u,clear:r,length:l,key:o,keys:s};t.default=p}.call("undefined"!=typeof window?window:self),e.exports=t.default},function(e,t){"use strict";t.__esModule=!0,function(){function e(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(a){if("TypeError"!==a.name)throw a;for(var n=x.BlobBuilder||x.MSBlobBuilder||x.MozBlobBuilder||x.WebKitBlobBuilder,r=new n,i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(t.type)}}function n(e,t){var n="";if(e&&(n=e.toString()),e&&("[object ArrayBuffer]"===e.toString()||e.buffer&&"[object ArrayBuffer]"===e.buffer.toString())){var r,i=u;e instanceof ArrayBuffer?(r=e,i+=d):(r=e.buffer,"[object Int8Array]"===n?i+=h:"[object Uint8Array]"===n?i+=p:"[object Uint8ClampedArray]"===n?i+=g:"[object Int16Array]"===n?i+=m:"[object Uint16Array]"===n?i+=w:"[object Int32Array]"===n?i+=v:"[object Uint32Array]"===n?i+=b:"[object Float32Array]"===n?i+=y:"[object Float64Array]"===n?i+=L:t(new Error("Failed to get type for BinaryArray"))),t(i+a(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=s+e.type+"~"+a(this.result);t(u+f+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function r(t){if(t.substring(0,c)!==u)return JSON.parse(t);var n,r=t.substring(E),a=t.substring(c,E);if(a===f&&l.test(r)){var o=r.match(l);n=o[1],r=r.substring(o[0].length)}var s=i(r);switch(a){case d:return s;case f:return e([s],{type:n});case h:return new Int8Array(s);case p:return new Uint8Array(s);case g:return new Uint8ClampedArray(s);case m:return new Int16Array(s);case w:return new Uint16Array(s);case v:return new Int32Array(s);case b:return new Uint32Array(s);case y:return new Float32Array(s);case L:return new Float64Array(s);default:throw new Error("Unkown type: "+a)}}function i(e){var t,n,r,i,a,s=.75*e.length,l=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),d=new Uint8Array(c);for(t=0;t<l;t+=4)n=o.indexOf(e[t]),r=o.indexOf(e[t+1]),i=o.indexOf(e[t+2]),a=o.indexOf(e[t+3]),d[u++]=n<<2|r>>4,d[u++]=(15&r)<<4|i>>2,d[u++]=(3&i)<<6|63&a;return c}function a(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=o[n[t]>>2],r+=o[(3&n[t])<<4|n[t+1]>>4],r+=o[(15&n[t+1])<<2|n[t+2]>>6],r+=o[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s="~~local_forage_type~",l=/^~~local_forage_type~([^~]+)~/,u="__lfsc__:",c=u.length,d="arbf",f="blob",h="si08",p="ui08",g="uic8",m="si16",v="si32",w="ur16",b="ui32",y="fl32",L="fl64",E=c+d.length,x=this,k={serialize:n,deserialize:r,stringToBuffer:i,bufferToString:a};t.default=k}.call("undefined"!=typeof window?window:self),e.exports=t.default},function(e,t,n){"use strict";t.__esModule=!0,function(){function e(e){var t=this,r={db:null};if(e)for(var i in e)r[i]="string"!=typeof e[i]?e[i].toString():e[i];var a=new Promise(function(n,i){try{r.db=h(r.name,String(r.version),r.description,r.size)}catch(r){return t.setDriver(t.LOCALSTORAGE).then(function(){return t._initStorage(e)}).then(n).catch(i)}r.db.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=r,n()},function(e,t){i(t)})})});return new Promise(function(e,t){e(n(3))}).then(function(e){return r.serializer=e,a})}function r(e,t){var n=this;"string"!=typeof e&&(f.console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new Promise(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})}).catch(r)});return d(r,t),r}function i(e,t){var n=this,r=new Promise(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT * FROM "+i.storeName,[],function(n,r){for(var a=r.rows,o=a.length,s=0;s<o;s++){var l=a.item(s),u=l.value;if(u&&(u=i.serializer.deserialize(u)),void 0!==(u=e(u,l.key,s+1)))return void t(u)}t()},function(e,t){r(t)})})}).catch(r)});return d(r,t),r}function a(e,t,n){var r=this;"string"!=typeof e&&(f.console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=new Promise(function(n,i){r.ready().then(function(){void 0===t&&(t=null);var a=t,o=r._dbInfo;o.serializer.serialize(t,function(t,r){r?i(r):o.db.transaction(function(r){r.executeSql("INSERT OR REPLACE INTO "+o.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){n(a)},function(e,t){i(t)})},function(e){e.code===e.QUOTA_ERR&&i(e)})})}).catch(i)});return d(i,n),i}function o(e,t){var n=this;"string"!=typeof e&&(f.console.warn(e+" used as a key, but it is not a string."),e=String(e));var r=new Promise(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("DELETE FROM "+i.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return d(r,t),r}function s(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return d(n,e),n}function l(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})}).catch(n)});return d(n,e),n}function u(e,t){var n=this,r=new Promise(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){n.executeSql("SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})}).catch(r)});return d(r,t),r}function c(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)},function(e,t){n(t)})})}).catch(n)});return d(n,e),n}function d(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var f=this,h=this.openDatabase;if(h){var p={_driver:"webSQLStorage",_initStorage:e,iterate:i,getItem:r,setItem:a,removeItem:o,clear:s,length:l,key:u,keys:c};t.default=p}}.call("undefined"!=typeof window?window:self),e.exports=t.default}])}),define("models/localisationmodel",["config","util/dom","util/object","util/string","util/addpublishers","lib/reqwest","lib/localforage.nopromises"],function(e,t,n,r,i,a,o){function s(){function l(t){t!==x&&-1!==e.settings.language.options.indexOf(t)&&f(t)}function u(e,t){"language"===e&&t!==x&&l(t)}function c(t){t.origin===e.origin&&t.data.language&&(S=!0,E=t.data.language,m(),g(t.data.language))}function d(e,t,n){if(!(e&&t&&n)){w(arguments,1);return v(e,w(arguments,1))}L.push({el:e,attribute:t,key:n,wasUpdated:!1,args:w(arguments)}),g()}function f(t){S=!1,a({url:e.language.dir+"/"+t+".json",type:"json",method:"get",error:function(e){S=!0,y.error.dispatch("I'm really sorry. I failed to load the language file for "+t+". This is a serious error that makes the app very hard to use. Maybe you can try reloading?")},success:function(e){h(e.lang.toLowerCase(),e)}})}function h(t,n){x=t,S=!0,E=n,p(n),m(),g(),e.language.debug&&(postMessage({availableLanguages:e.settings.language.options},e.origin),postMessage({loaded:!0},e.origin))}function p(t){o.setItem(e.keys.language,t)}function g(e){S&&(cancelAnimationFrame(k),k=requestAnimationFrame(function(){for(var n,i=L.length-1;i>=0;i--)n=L[i],t.isElement(n.el)?n.wasUpdated||("innerHTML"===n.attribute?n.el.innerHTML=r.markdownToHtml(v(n.key,n.args,e),I):n.el[n.attribute]=v(n.key,n.args,e),n.wasUpdated=!0):L.splice(i,1);y.update.dispatch()}))}function m(){L.forEach(function(e){e.wasUpdated=!1})}function v(e,t,r){var i="";r=r||E;try{i=n.getObjectByString(e,r)}catch(t){S&&(i=e)}if(Array.isArray(i)&&(i=i.join("\n\n")),t&&t.length){var a;t.forEach(function(e,t){a=new RegExp("{\\$"+(t+1)+"}"),"string"==typeof e?i=i.replace(a,e):"function"==typeof e&&(i=i.replace(a,e()))})}return i}function w(e,t){t=t||3;var n;e.length>t&&(n=[]);for(var r=t,i=e.length;r<i;r++)n[n.length]=e[r];return n}if(!(this instanceof s))return new s;var b=this,y=i(b,"update","newlanguage","error"),L=[],E="",x="",k=NaN,S=!1,I={links:{newTab:!0}},A=(navigator.language||navigator.userLanguage||"").toLowerCase();if(""!==A){var _=!1;e.settings.language.options.indexOf(A)>-1?(e.settings.language.value=A,_=!0):e.settings.language.options.forEach(function(t){A.substr(0,2)===t.substr(0,2)&&(e.settings.language.value=t,_=!0)}),_||setTimeout(y.newlanguage.dispatch,100,A)}!function(){o.getItem(e.keys.language,function(t,n){t||(n&&n.lang?h(n.lang,n):f(e.language.preset))})}(),e.language.debug&&addEventListener("message",c,!1),b.setLanguage=l,b.localizeText=d,b.settingUpdated=u}return s.sharedInstance=s(),s}),define("util/localizetext",["models/localisationmodel"],function(e){function t(){return e.sharedInstance.localizeText.apply(e.sharedInstance,arguments)}return t}),define("util/el",["util/dom","util/localizetext"],function(e,t){function n(e,t,n){var r=-1!==o.indexOf(e),i=r?document.createElementNS(s,e):document.createElement(e);return r&&document.createElementNS("http://www.w3.org/2000/svg","rect"),t="string"==typeof t?[].concat(t.split(" ")):t,Array.isArray(t)&&t.forEach(function(e){i.classList.add(e)}),n&&n.appendChild&&n.appendChild(i),i}function r(r,i,a,o,s){var l=n("button",a,o);return"string"==typeof r?t(l,"textContent",r):e.isElement(r)&&l.appendChild(r),t(l,"title",i),"function"==typeof s&&l.addEventListener("click",s),l}function i(r,i,a,o,s,l){var u=n("a",s,l);return"string"==typeof r?t(u,"textContent",r):e.isElement(r)&&u.appendChild(r),i&&t(u,"title",i),a&&(u.href=a),o&&(u.target=o),u}function a(r,i,a,o){var s=n("label",a,o);return"string"==typeof r?t(s,"textContent",r):e.isElement(r)&&s.appendChild(r),i&&s.setAttribute("for",i),s}var o=["g","svg","rect"],s="http://www.w3.org/2000/svg";return{createEl:n,createButton:r,createLink:i,createLabel:a}}),define("views/appview",["util/el","util/localizetext"],function(e,t){function n(r){function i(){return document.documentElement.classList.add("is-online"),o}function a(){return document.documentElement.classList.remove("is-online"),o}if(!(this instanceof n))return new n(r);var o=this,s=e.createEl("div","app",r);t(document.title,"textContent","index.title"),t(document.documentElement,"lang","lang"),o.el=s,o.showOnlineOptions=i,o.hideOnlineOptions=a}return n}),define("views/dialog",["util/el","util/dom","util/addpublishers"],function(e,t,n){function r(){a.forEach(function(e){e.hide()})}function i(o,s,l){function u(){return m||(r(),b.classList.add("is-visible"),m=!0,g.show.dispatch(),clearTimeout(v),v=setTimeout(function(){b.classList.add("is-active"),w&&l.classList.add("is-active")},10)),p}function c(){return m&&(b.classList.remove("is-active"),m=!1,g.hide.dispatch(),w&&l.classList.remove("is-active"),clearTimeout(v),v=setTimeout(function(){b.classList.remove("is-visible")},500)),p}function d(){return m?c():u(),p}function f(){var e=document.createElement("div");e.classList.add("dialog-item"),b.appendChild(e);for(var t=0,n=arguments.length;t<n;t++)"string"==typeof arguments[t]?arguments[t].split(" ").forEach(function(t){e.classList.add(t)}):(arguments[t].wrapperEl=e,e.appendChild(arguments[t]));return p}function h(e){return e.parentNode.parentNode.removeChild(e.parentNode),p}if(!(this instanceof i))return new i(o,s,l);var p=this,g=n(p,"hide show"),m=!1,v=NaN,w=!1,b=e.createEl("div","dialog color-bg-light "+o,s);l&&t.isElement(l)&&(w=!0,l.addEventListener("click",d)),p.add=f,p.remove=h,p.show=u,p.hide=c,p.toggle=d,p.el=b,a.push(p)}var a=[];return i.closeAll=r,i}),define("util/math",[],function(){function e(e,t,n,r,i,a){var o=(e-t)/(n-t)*(i-r)+r;return a&&(o=r>i?Math.min(Math.max(o,i),r):Math.min(Math.max(o,r),i)),o}return{mapRange:e}}),define("views/navview",["util/el","util/dom","views/dialog","util/addpublishers","util/math","util/localizetext"],function(e,t,n,r,i,a){function o(s){function l(){w?c():u()}function u(){w=!0,requestAnimationFrame(function(){y.classList.add("is-active"),T.classList.add("is-active")}),L.togglestart.dispatch(!0),setTimeout(function(){L.toggleend.dispatch(!0)},300)}function c(){w=!1,n.closeAll(),requestAnimationFrame(function(){y.classList.remove("is-active"),T.classList.remove("is-active")}),L.togglestart.dispatch(!1),setTimeout(function(){L.toggleend.dispatch(!1)},300)}function d(){window.innerWidth<=R&&c()}function f(e,t,n){N||(s.addEventListener("touchmove",m),s.addEventListener("touchend",v),N=!0,touchIdentifier=n,j.x=e,j.y=t,M.x=e,M.y=t,requestAnimationFrame(function(){y.classList.add("is-swiping"),T.classList.add("is-swiping")}))}function h(){if(N){s.removeEventListener("touchmove",m),s.addEventListener("touchend",v),N=!1,requestAnimationFrame(function(){y.classList.remove("is-swiping"),T.classList.remove("is-swiping"),t.setTransform(y,""),t.setTransform(T,""),t.setTransform(I,""),t.setTransform(A,""),t.setTransform(_,""),t.setTransform(S,""),S.style.fill="",E.style.width="",E.style.opacity=""});var e=M.x-j.x;F>-O&&F<0&&Math.abs(e)>0&&(e>0?F<.75*-O?c():u():F<.25*-O?c():u())}}function p(e,n,r){M.x=e,M.y=n;var a=M.x-j.x,o=!1;w?a<0&&a>=-O?(o=!0,F=Math.round(Math.max(a,-O))):h():a>0&&a<=O?(o=!0,F=-O+Math.round(Math.min(a,O))):h(),o&&requestAnimationFrame(function(){t.setTransform(y,"translateX("+F+"px)");var e="translateX("+i.mapRange(F,-O,0,0,242)+"px)";t.setTransform(T,e);var n=["rotateZ("+i.mapRange(F,-O,0,0,45)+"deg)","translateY("+i.mapRange(F,-O,0,0,5.1)+"px)"].join(" ");t.setTransform(I,n),t.setTransform(A,"scaleX("+i.mapRange(F,-O,0,1,0)+")");var r=["rotateZ("+i.mapRange(F,-O,0,0,-45)+"deg)","translateY("+i.mapRange(F,-O,0,0,-5.1)+"px)"].join(" ");t.setTransform(_,r),t.setTransform(S,"rotateZ("+i.mapRange(F,-O,0,0,-90)+"deg)"),S.style.fill="hsl(0, 0%, "+i.mapRange(F,-O,0,0,100)+"%)",E.style.width=i.mapRange(F,-O,0,50,0)+"px",E.style.opacity=i.mapRange(F,-O,0,1.5,0,!0).toFixed(2)})}function g(e){if(window.innerWidth<=R&&!N)for(H=0,U=e.touches.length;H<U;H++)if(D=e.touches[H],!w&&D.clientX<=q||w&&D.clientX<=q+O){f(D.clientX,D.clientY,D.identifier);break}}function m(e){if(e.changedTouches){var t=!1;for(H=0,U=e.touches.length;H<U;H++)if(D=e.touches[H],D.identifier===touchIdentifier){p(D.clientX,D.clientY,D.identifier),t=!0;break}t||h()}else h()}function v(e){h()}if(!(this instanceof o))return new o(s);var w=!1,b=this,y=e.createEl("nav","nav color-bg",s),L=r(b,"togglestart","toggleend"),E=e.createEl("span","nav-toggle-button-text");a(E,"textContent","nav.menu"),a(E,"title","nav.menutitle");var x=document.createElement("div");x.classList.add("svg-wrapper");var k=document.getElementById("svg");k.setAttribute("viewBox","0 0 24 24"),x.appendChild(k);var S=document.createElementNS("http://www.w3.org/2000/svg","g");S.setAttribute("id","menu"),S.setAttributeNS(null,"fill","#000"),k.appendChild(S);var I=e.createEl("rect",null,S);I.setAttribute("id","rect-1"),I.setAttributeNS(null,"x","3"),I.setAttributeNS(null,"y","6"),I.setAttributeNS(null,"width","18"),I.setAttributeNS(null,"height","2");var A=e.createEl("rect",null,S);A.setAttributeNS(null,"id","rect-2"),A.setAttributeNS(null,"x","3"),A.setAttributeNS(null,"y","11"),A.setAttributeNS(null,"width","18"),A.setAttributeNS(null,"height","2");var _=e.createEl("rect",null,S);_.setAttributeNS(null,"id","rect-3"),_.setAttributeNS(null,"x","3"),_.setAttributeNS(null,"y","16"),_.setAttributeNS(null,"width","18"),_.setAttributeNS(null,"height","2"),x.appendChild(k);var T=e.createButton(E,"nav.menutitle","nav-toggle-button",s);T.appendChild(x),T.addEventListener("click",l,!1);var C=e.createEl("h1","nav-headline",y);a(C,"textContent","index.title");var D,R=600,O=300,q=60,N=!1,j={x:0,y:0},M={x:0,y:0},F=-O,H=0,U=0;s.addEventListener("touchstart",g),b.el=y,b.closeSmallScreenNav=d}return o}),define("views/controlsview",["util/addpublishers","util/el","util/localizetext"],function(e,t,n){function r(i,a,o){function s(){var e=h();for(var t in e)m.update.dispatch(t,e[t])}function l(e){if(w&&!v){var t=e.target.getAttribute("data-key"),n=h();n[t]!==e.target.value&&(n[t]=parseInt(e.target.value,10),m.update.dispatch(t,n[t]))}}function u(e){w&&m.random.dispatch()}function c(){w?d():f()}function d(){E.classList.remove("is-active"),k.classList.remove("is-active"),a.classList.remove("controls-enabled"),w=!1,clearTimeout(b),b=setTimeout(function(){E.classList.remove("is-visible")},500)}function f(){E.classList.add("is-visible"),w=!0,clearTimeout(b),b=setTimeout(function(){E.classList.add("is-active"),k.classList.add("is-active"),a.classList.add("controls-enabled")},10)}function h(){var e={};for(var t in y)e[t]=parseInt(y[t].value,10);return e}function p(e,t){v=!0,y[e].value=t,L[e].value=t,v=!1}if(!(this instanceof r))return new r(i,a,o);o=o||{};var g=this,m=e(g,"update","random"),v=!1,w=!0,b=0,y={},L={},E=t.createEl("div","controls",i),x=t.createEl("div","controls-wrapper",E),k=t.createButton("controls.controls","controls.controlstitle","controls-toggle-button button is-active",a,c);for(var S in o)!function(e,r){var i=t.createEl("div","control",x),a=t.createLabel("controls."+e,"input-"+e,"control-label",i);n(a,"title","controls."+e);var o=t.createEl("input","control-input",i);o.setAttribute("data-key",e),o.setAttribute("id","input-"+e),o.type="range",o.value=r.value||0,o.min=r.min||0,o.max=r.max||100,o.addEventListener("input",l),o.addEventListener("change",l),y[e]=o;var s=t.createEl("input","control-value",i);s.setAttribute("data-key",e),s.type="number",s.value=r.value||0,s.min=r.min||0,s.max=r.max||100,s.addEventListener("input",l),s.addEventListener("change",l),L[e]=s,l({target:o})}(S,o[S]);f(),t.createButton("controls.randomize","controls.randomizetitle","random-button button",x,u),g.loadInitialValues=s,g.setValue=p}return r}),define("util/time",[],function(){function e(e){return e.toISOString()}function t(e){return new Date(parseInt(e,10))}function n(e){return o&&Intl.DateTimeFormat.supportedLocalesOf([a]).length&&e.toLocaleDateString&&e.toLocaleTimeString?e.toLocaleDateString(a)+" "+e.toLocaleTimeString(a):r(e)+" "+i(e)}function r(e){return o&&Intl.DateTimeFormat.supportedLocalesOf([a]).length&&e.toLocaleDateString?e.toLocaleDateString(a):"en-us"===navigator.language.toLowerCase()?e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear():e.getDate()+"."+e.getMonth()+"1."+e.getFullYear()}function i(e){if(o&&Intl.DateTimeFormat.supportedLocalesOf([a]).length&&e.toLocaleTimeString)return e.toLocaleTimeString(a);var t=e.getHours(),n=e.getMinutes();if(t<10&&(t="0"+t),n<10&&(n="0"+n),navigator.language.toLowerCase().indexOf("en")>=0){var r="AM";return t>12&&(t-=12,r="PM"),t+":"+n+" "+r}return t+":"+n}var a=navigator.language||navigator.userLanguage||"en-us",o=!!window.Intl;return{dateToStr:e,dateToLocalStr:r,timeToLocalStr:i,dateTimeToLocalStr:n,timestampToDate:t}}),define("views/openfileview",["util/browser","util/addpublishers","util/el","util/time","util/localizetext","views/dialog"],function(e,t,n,r,i,a){function o(s){function l(e){e.target&&e.target.files&&e.target.files[0]&&E.openfile.dispatch(e.target.files[0])}function u(e){if(v)if(e&&Object.keys(e).length){w&&(h(w),w=null);var t;for(var r in e)t=v.querySelector('[data-uid="'+r+'"]'),c(t,r,e[r]);for(var a=v.querySelectorAll("[data-uid]"),o=0,s=a.length;o<s;o++){var l=a[o].getAttribute("data-uid");l&&!e[l]&&h(a[o])}}else{if(e&&0===Object.keys(e).length)for(var a=v.querySelectorAll("[data-uid]"),o=0,s=a.length;o<s;o++)h(a[o]);w||(w=n.createEl("li","no-items"),i(w,"textContent","file.norecent"),v.appendChild(w))}return L}function c(e,t,n){if(n.src&&n.values&&!e)d(t,n);else if(e)if(n.src||n.values){var r=e.querySelector(".entry-shared-button-wrapper");!n.deleteHash&&r&&(r.parentNode.removeChild(r),e.classList.remove("has-offline-button")),n.deleteHash&&!r&&f(e,n.deleteHash,n.publicUrl,t)}else h(e)}function d(e,t){if(t){var a=r.timestampToDate(t.timestamp),o=n.createEl("li","entry clear dialog-list-item",v);o.setAttribute("data-uid",e);var s=n.createEl("img","entry-thumb",o);s.src=t.thumbnail,s.addEventListener("click",m(e));var l=n.createEl("p","entry-text",o),u=n.createEl("p","entry-name",l);t.name?u.textContent=t.name:i(u,"textContent","file.untitled");var c=n.createEl("time","entry-datetime",l);c.setAttribute("datetime",a.toISOString());n.createEl("span","entry-date",c).textContent=r.dateToLocalStr(a);n.createEl("span","entry-time",c).textContent=r.timeToLocalStr(a);var d=n.createEl("div","entry-button-wrapper",o);n.createButton("file.del","file.deltitle","item-delete-button button",d,p(e)),n.createButton("file.openimage","file.openimagetitle","item-load-button button",d,m(e)),t.deleteHash&&t.publicUrl&&f(o,t.deleteHash,t.publicUrl,e)}}function f(e,t,r,i){var a=n.createEl("div","entry-shared-button-wrapper is-online-only",e);e.classList.add("has-offline-button"),n.createButton("file.offline","file.offlinetitle","item-offline-button button",a,g(i,t)),n.createLink("file.openlink","file.openlinktitle",r,"_blank","entry-shared-link button",a)}function h(e){e.parentNode.removeChild(e)}function p(e){return function(){E.deletefromlocalstorage.dispatch(e)}}function g(e,t){return function(){var n=v.querySelector('[data-uid="'+e+'"] .item-offline-button');n&&n.setAttribute("disabled","disabled"),E.deletefromimgur.dispatch(e,t)}}function m(e){return function(){y.hide(),E.openfromlocalstorage.dispatch(e)}}if(!(this instanceof o))return new o(s);var v,w,b,y,L=this,E=t(L,"openfile","deletefromlocalstorage","openfromlocalstorage","deletefromimgur");if(e.getFeature(window,"FileReader")){b=n.createButton("file.open","file.opentitle","open-button nav-button",s),y=a("open-file-dialog",s,b);var x=n.createLabel("file.importtitle","input-file","file-label label");fileInputEl=document.createElement("input"),fileInputEl.classList.add("file-input"),fileInputEl.type="file",fileInputEl.id="input-file",fileInputEl.accept="image/*",fileInputEl.addEventListener("change",l);var k=n.createLabel("file.import","input-file","file-button button");y.add(x,fileInputEl,k),L.fileinput=fileInputEl}if(e.test("localforage")){v=n.createEl("ul","storage-list dialog-list");var S=n.createLabel("file.recent","file.recenttitle","load-label label");y.add(S,v)}L.updateList=u,L.dialog=y}return o}),define("views/fullscreenview",["util/browser","util/el"],function(e,t){function n(r){function i(e){l=document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen,l?document.documentElement.classList.add("is-fullscreen"):document.documentElement.classList.remove("is-fullscreen")}function a(){l?s():o(document.documentElement)}function o(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function s(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}if(!(this instanceof n))return new n(r);var l=!1;e.test("fullscreen")&&(t.createButton("controls.fullscreen","controls.fullscreentitle","fullscreen-button",r,a),document.addEventListener("webkitfullscreenchange",i,!1),document.addEventListener("mozfullscreenchange",i,!1),document.addEventListener("fullscreenchange",i,!1),document.addEventListener("MSFullscreenChange",i,!1))}return n}),define("util/mediastream",[],function(){var e=window.MediaStream;void 0===e&&"undefined"!=typeof webkitMediaStream&&(e=webkitMediaStream),void 0===e||"stop"in e.prototype||(e.prototype.stop=function(){this.getAudioTracks().forEach(function(e){e.stop()}),this.getVideoTracks().forEach(function(e){e.stop()})})}),define("views/webcamview",["util/browser","util/addpublishers","util/el","util/dom","views/dialog","util/mediastream"],function(e,t,n,r,i){function a(o){function s(e){w||navigator.getUserMedia(b,u,c)}function l(e){x.classList.add("is-taking-picture"),setTimeout(function(){y.video.dispatch(p),x.classList.remove("is-taking-picture")},50)}function u(e){var t=!0;if(void 0!==p.mozSrcObject?p.mozSrcObject=e:window.URL?p.src=window.URL.createObjectURL(e):t=!1,t){m.show();try{p.play()}catch(e){}h(),w=!0,g=e}else m.hide(),y.error.dispatch("webcam.error.access")}function c(){g&&f(),d(),y.error.dispatch("webcam.error.access")}function d(){m.hide(),f()}function f(){g&&(p.pause(),p.mozSrcObject&&(p.mozSrcObject=null),p.src&&(p.src=null,p.src=""),g.stop&&g.stop(),g=null,w=!1)}function h(){p.videoHeight>0?(p.width=p.videoWidth,p.height=p.videoHeight):setTimeout(h,100)}if(!(this instanceof a))return new a(o);var p,g,m,v=this,w=!1,b={video:!0},y=t(v,"video","error");if(e.test("getusermedia")){var L=n.createButton("webcam.webcam","webcam.webcamtitle","nav-button photo-button",o),E=n.createLabel("webcam.webcamlabel",null,"webcam-label label"),x=n.createEl("div","video-wrapper"),p=document.createElement("video");p.classList.add("cam-video"),p.controls=!1,r.setTransform(p,"scale(-1, 1)"),p.addEventListener("click",l),x.appendChild(p);var k=n.createButton("webcam.trigger","webcam.triggertitle","cam-trigger-button button",null,l);m=i("webcam-dialog",o,L).add(E,x,k).on("show",s).on("hide",d)}}return a}),define("util/css",[],function(){function e(e){var t=window.getComputedStyle(e);return t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform")}function t(e){"none"===e&&(e="matrix(0,0,0,0,0)");var t={},n=e.match(/([-+]?[\d\.]+)/g);return t.rotate=(Math.round(Math.atan2(parseFloat(n[1]),parseFloat(n[0]))*(180/Math.PI))||0).toString()+"deg",t.translateStr=n[5]?n[4]+"px, "+n[5]+"px":n[4]?n[4]+"px":"",t.translateX=parseFloat(n[4]),t.translateY=n[5]?parseFloat(n[5]):0,t}return{getCSSMatrix:e,cssMatrixToTransformObj:t}}),define("views/panzoom",["util/css","util/dom","util/addpublishers"],function(e,t,n){function r(e){return{x:e.pageX,y:e.pageY}}function i(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return Math.sqrt(n*n+r*r)}function a(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function o(e){return e.touches?Array.prototype.map.call(e.touches,r):[r(e)]}function s(r,l,u){function c(){d(O.translateX||0,O.translateY||0,1)}function d(e,t,n,i){if(cancelAnimationFrame(H),C&&l!==r&&_&&(i=i||l.getBoundingClientRect(),e!==q||t!==N||n!==j)){var a=1/(j/n);e+i.width*a<D&&(e=D-i.width*a),e>_.width-D&&(e=_.width-D),t+i.height*a<D&&(t=D-i.height*a),t>_.height-D&&(t=_.height-D)}n=Math.min(5,Math.max(.01,n)),j===n&&5===n||(q=e,N=t,j=n,A.scale.dispatch(j),H=requestAnimationFrame(f))}function f(){l.style.WebkitTransform=l.style.transform="translate3d("+q+"px, "+N+"px, 0) scale("+j+")"}function h(e){if(T(e.target)&&I){e.preventDefault();var t=l.getBoundingClientRect(),n=e.deltaY;1===e.deltaMode&&(n*=15),n=Math.max(Math.min(n,60),-60);var r=n/300+1;j*r<.05||d(q-(e.pageX-t.left)*(r-1),N-(e.pageY-t.top)*(r-1),j*r,t)}}function p(e){document.addEventListener("mousemove",m),document.addEventListener("mouseup",v),document.addEventListener("touchmove",m),document.addEventListener("touchend",v)}function g(e){"mousedown"==e.type&&1!=e.which||T(e.target)&&t.isDescendant(r,e.target)&&(e.preventDefault(),F=o(e),1===++M&&p(e))}function m(e){if(e&&e.target&&t.isDescendant(r,e.target)){e.preventDefault();var n=o(e),s=n.reduce(a),u=F.reduce(a),c=l.getBoundingClientRect(),f=q+s.x-u.x,h=N+s.y-u.y;if(n[1]){if(!I)return;var p=i(n[0],n[1])/i(F[0],F[1]);d(f-(s.x-c.left)*(p-1),h-(s.y-c.top)*(p-1),j*p,c)}else d(f,h,j);F=n}}function v(e){if(e.preventDefault(),M--,F.pop(),M)return void(F=o(e));document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",v),document.removeEventListener("touchmove",m),document.removeEventListener("touchend",v)}function w(){W={width:r.clientWidth,height:r.clientHeight},P={width:l.clientWidth,height:l.clientHeight},_=r.getBoundingClientRect(),d(q,N,j)}function b(){clearTimeout(z),z=setTimeout(function(){w(),Math.abs(j-V)<=.01&&L()},100)}function y(){var e=k();return d(e.x,e.y,e.scale),S}function L(){function e(){t=a.x-q,n=a.y-N,r=a.scale-j,Math.abs(t)>1||Math.abs(n)>1||Math.abs(r)>.01?(d(q+t*i,N+n*i,j+r*i),B=requestAnimationFrame(e)):d(a.x,a.y,a.scale)}var t=0,n=0,r=0,i=.1,a=k();return V=a.scale,cancelAnimationFrame(U),cancelAnimationFrame(B),B=requestAnimationFrame(e),S}function E(e,t){"canZoomWithPointer"===e&&"boolean"==typeof t&&(I=t)}function x(e){function t(){i=n-q,a=r-N,o=e-j,Math.abs(i)>1||Math.abs(a)>1||Math.abs(o)>.01?(d(q+i*s,N+a*s,j+o*s),U=requestAnimationFrame(t)):d(n,r,e)}var n=(W.width-P.width*e)/2,r=(W.height-P.height*e)/2,i=0,a=0,o=0,s=.2;return cancelAnimationFrame(U),cancelAnimationFrame(B),t(),S}function k(){w();var e=1;return(P.width>W.width||P.height>W.height)&&(e=Math.min(W.width/P.width,(W.height-80)/P.height)),{x:(W.width-P.width*e)/2,y:(W.height-P.height*e)/2,scale:e}}if(!(this instanceof s))return new s(l,r,u);var S=this,I=!0,A=n(S,"scale");u=u||{};var _,T=u.shouldCaptureFn||function(e){return!0},C="boolean"!=typeof u.limitToContainer||u.limitToContainer,D=u.limitPadding||50,R=e.getCSSMatrix(l),O=e.cssMatrixToTransformObj(R),q=O.translateX||0,N=O.translateY||0,j=1,M=0,F=[],H=NaN,U=NaN,B=NaN,z=NaN,P={width:100,height:100},W={width:100,height:100},V=1;r.addEventListener("mousedown",g),r.addEventListener("touchstart",g),r.addEventListener("wheel",h),window.addEventListener("resize",b),l.style.WebkitTransformOrigin=l.style.transformOrigin="0 0",w(),this.updateContainerBounds=w,this.reset=c,this.setToCenter=y,this.animateToCenter=L,this.setScale=x,this.settingUpdated=E,this.resized=b}return s}),define("views/canvasview",["util/addpublishers","util/el","views/panzoom"],function(e,t,n){function r(i,a){function o(e){f.dblclick.dispatch()}function s(e){g.style.width=e.width+"px",g.style.height=e.height+"px",h.width===e.width&&h.height===e.height||(m.width=e.width,m.height=e.height,h.width=e.width,h.height=e.height,w.animateToCenter(),f.imagesizechange.dispatch()),v.putImageData(e,0,0),w.updateContainerBounds()}function l(e){return function(){e(m.toDataURL("image/jpeg",100))}}function u(){clearTimeout(b),p.classList.remove("is-visible")}function c(){clearTimeout(b),b=setTimeout(function(){p.classList.add("is-visible")},400)}if(!(this instanceof r))return new r(i,a);var d=this,f=e(d,"update","imagesizechange","scale","dblclick"),h={width:0,height:0},p=t.createEl("div","panzoom",i),g=t.createEl("div","canvas-wrapper",p),m=t.createEl("canvas","glitch-canvas",g),v=m.getContext("2d"),w=n(g,p).on("scale",function(e){f.scale.dispatch(e),f.update.dispatch("scale",e)}),b=NaN;Date.now();p.addEventListener("dblclick",o),d.putImageData=s,d.moveToCenter=w.moveToCenter,d.animateToCenter=w.animateToCenter,d.setScale=w.setScale,d.createImageUrl=l,d.hide=u,d.show=c,d.resized=w.resized,d.el=p,d.panZoom=w}return r}),define("views/canvascontrolsview",["util/addpublishers","util/el"],function(e,t){function n(r){function i(e){c.center.dispatch()}function a(e){d||(c.scale.dispatch(parseFloat(h.value)),c.update.dispatch("scale",parseFloat(h.value)))}function o(e){c.scale.dispatch(1),c.update.dispatch("scale",1)}function s(e){return d=!0,h.value=e,d=!1,u}function l(e,t){return"scale"===e&&s(t),u}if(!(this instanceof n))return new n(r)
;var u=this,c=e(u,"update","center","scale"),d=!1,f=t.createEl("div","workspace-controls clear",r);t.createButton("controls.center","controls.centertitle","center-button button",f,i),t.createButton("controls.original","controls.originaltitle","scale-to-original-button button",f,o),t.createLabel("controls.zoom","control.zoomtitle","scale-label",f);var h=t.createEl("input","scale-slider",f);h.id="zoom",h.type="range",h.min=.01,h.max=5,h.step=.001,h.addEventListener("input",a),h.addEventListener("change",a),u.setScale=s,u.setValue=l,u.el=f}return n}),define("views/saveview",["util/el","util/addpublishers","util/browser","views/dialog","util/time"],function(e,t,n,r,i){function a(o){function s(e){p.toggle(),b.savetolocalstorage.dispatch()}function l(e,t){t=t||"glitched";var n=t.split("/"),r=n.length>1?n.pop():n[0];r=r.split(".").shift(),m=new Date,v=i.dateTimeToLocalStr(m);var a=r+"-glitched-"+v+".png";a=a.replace(/(\s|\/|:)/gim,"-"),g.setAttribute("download",a),g.href=e}function u(){y=!0,b.show.dispatch()}function c(){y=!1}function d(){return y}if(!(this instanceof a))return new a(o);var f,h,p,g,m,v,w=this,b=t(w,"savetolocalstorage","show"),y=!1;n.test("localforage")&&(h=e.createButton("file.saveinbrowser","file.saveinbrowsertitle","nav-button save-view-button",o),p=r("save-dialog",o,h),g=e.createLink("file.download","file.downloadtitle",null,null,"download-link button"),g.target="_blank",f=e.createButton("file.save","file.savetitle","save-button button",null,s),p.on("show",u).on("hide",c).add(f,g)),w.updateDownloadLink=l,w.getActive=d}return a}),define("views/shareview",["config","util/addpublishers","views/dialog","util/el","util/browser","util/time","util/string","util/localizetext"],function(e,t,n,r,i,a,o,s){function l(u){function c(){O&&(D.share.dispatch(),m())}function d(e,t){clearTimeout(R);var n="https://imgur.com/"+t;T.el.classList.add("has-links"),V.textContent=e,V.href=e,V.setAttribute("data-imgurid",t),X.href=n,G.href=A("reddit",e,n),Q.href=A("twitter",e,n),Y.href=A("facebook",e,n),J.href=A("pinterest",e,n),Z.href=A("vkontakte",e,n)}function f(){T.el.classList.remove("has-links"),V.textContent="",V.href="about:blank",G.href="about:blank",Q.href="about:blank",Y.href="about:blank"}function h(){T.el.classList.add(j)}function p(){T.el.classList.remove(j)}function g(e,t,n){d(e,t),v()}function m(e){return T.el.classList.remove(N),clearTimeout(R),R=setTimeout(f,400),C}function v(){return T.el.classList.add(N),C}function w(){return O=!0,P.removeAttribute(H),C}function b(){return O=!1,P.setAttribute(H,H),C}function y(e){if(K){if(e&&Object.keys(e).length){var t;for(var n in e)t=K.querySelector('[data-uid="'+n+'"]'),e[n].deleteHash&&!t?L(n,e[n]):!e[n].deleteHash&&t&&E(t);for(var r=K.querySelectorAll("[data-uid]"),i=0,a=r.length;i<a;i++){var o=r[i].getAttribute("data-uid");o&&!e[o]&&E(r[i])}}S(e)?K.wrapperEl.classList.remove(M):K.wrapperEl.classList.add(M)}return C}function L(e,t){if(t){var n=a.timestampToDate(t.timestamp),i=r.createEl("li","entry clear dialog-list-item",K);i.setAttribute("data-uid",e);var o=r.createEl("img","entry-thumb",i);o.src=t.thumbnail,o.addEventListener("click",k(e));var l=r.createEl("p","entry-text",i),u=r.createEl("p","entry-name",l);t.name?u.textContent=t.name:s(u,"textContent","file.untitled");var c=r.createEl("time","entry-datetime",l);c.setAttribute("datetime",n.toISOString());r.createEl("span","entry-date",c).textContent=a.dateToLocalStr(n);r.createEl("span","entry-time",c).textContent=a.timeToLocalStr(n);var d=r.createEl("div","entry-button-wrapper",i);r.createLink("file.openlink","file.openlinktitle",t.publicUrl,F,"open-link-button button "+q,d),r.createButton("file.offline","file.offlinetitle","item-offline-button button "+q,d,x(e,t.deleteHash))}}function E(e){e.parentNode.removeChild(e)}function x(e,t){return function(){var n=K.querySelector('[data-uid="'+e+'"] .item-offline-button');n&&n.setAttribute(H,H),D.deletefromimgur.dispatch(e,t)}}function k(e){return function(){T.hide(),D.openfromlocalstorage.dispatch(e)}}function S(e){var t=!1;for(var n in e)if(e[n].deleteHash){t=!0;break}return t}function I(e,t){if("imgurremovefail"===t.type&&t.uid){var n=K.querySelector('[data-uid="'+t.uid+'"] .item-offline-button');n&&n.removeAttribute(H)}}function A(t,n,r){var i=s("share.link.description.edited"),a=s("share.link.title"),l={};return-1!==["reddit","vkontakte"].indexOf(t)&&(l.title=a),-1!==["pinterest","vkontakte"].indexOf(t)&&(l.description=i+" "+e.share.appURL,l.url=e.appURL),"pinterest"===t&&(l.media=n),"vkontakte"===t&&(l.image=n),"reddit"===t&&(l.url=n),"facebook"===t&&(l.u=r),"twitter"===t&&(l.text=s("share.link.description.withname")+" "+r+" "+e.share.appURL),e.share.sharer[t]+"?"+o.objToQueryStr(l)}function _(e){return function(){return s(e)}}if(!(this instanceof l))return new l(u);var T,C=this,D=t(C,"share","deletefromimgur"),R=NaN,O=!0,q="is-online-only",N="was-loaded",j="is-loading",M="is-empty",F="_blank",H="disabled",U=r.createButton("share.share","share.sharetitle","nav-button share-toggle-button "+q,u),B=r.createEl("span","upload-status");s(B,"textContent","share.uploading");var z=r.createEl("p","share-info");s(z,"innerHTML","share.info");var P=r.createButton("share.upload","share.uploadtitle","upload-button button "+q,null,c),W=r.createLabel("share.imagelink","img-link-input","img-link-label label"),V=r.createLink(null,"share.opennewtabtitle",null,F,"img-link");V.id="img-link-input";var X=r.createLink(null,null,null,F,"imgur-link button");s(X,"textContent","share.openon",_("share.target.imgur")),s(X,"title","share.openontitle",_("share.target.imgur"));var G=r.createLink(null,null,null,F,"reddit-link button");s(G,"textContent","share.shareon",_("share.target.reddit")),s(G,"title","share.shareontitle",_("share.target.reddit"));var Q=r.createLink(null,null,null,F,"twitter-link button");s(Q,"textContent","share.shareon",_("share.target.twitter")),s(Q,"title","share.shareontitle",_("share.target.twitter"));var Y=r.createLink(null,null,null,F,"facebook-link button");s(Y,"textContent","share.shareon",_("share.target.facebook")),s(Y,"title","share.shareontitle",_("share.target.facebook"));var J=r.createLink(null,null,null,F,"pinterest-link button");s(J,"textContent","share.shareon",_("share.target.pinterest")),s(J,"title","share.shareontitle",_("share.target.pinterest"));var Z=r.createLink(null,null,null,F,"vkontakte-link button");s(Z,"textContent","share.shareon",_("share.target.vkontakte")),s(Z,"title","share.shareontitle",_("share.target.vkontakte"));var K;if(T=n("share-dialog",u,U).add(q,z).add(q,P).add(q,"loader",B).add(q,W,V).add(q,Q).add(q,Y).add(q,X).add(q,G).add(q,Z).add(q,J),i.test("localforage")){K=r.createEl("ul","shared-list dialog-list");var $=r.createLabel("share.recentlyshared",null,"load-label label");T.add("has-list shared-list",$,K)}C.showUpload=h,C.hideUpload=p,C.showShareLinks=v,C.hideShareLinks=m,C.uploadComplete=g,C.updateList=y,C.showOnlineOptions=w,C.hideOnlineOptions=b,C.handleError=I}return l}),define("views/indicatorview",["util/el","util/localizetext"],function(e,t){function n(r){function i(e,t,n){s("welcome",e,t,n)}function a(e,t){s("message",e,t)}function o(e,t){s("error",e,t)}function s(e,t,n,r){r=r||v[e]||7e3,m?h.push({type:e,message:t,data:n,fadeOutDelay:r}):l(e,{message:t,data:n,fadeOutDelay:r})}function l(n,r){var i=e.createEl("div","notification notification-"+n,w);r.data&&r.data.innerHTML?r.data.args&&r.data.args.length?t.apply(null,[i,"innerHTML",r.message].concat(r.data.args)):t.apply(null,[i,"innerHTML",r.message]):t(i,"textContent",r.message),i.id="notification-"+Date.now(),i.addEventListener("click",d),w.classList.add("is-active"),m=!0,requestAnimationFrame(function(){i.classList.add("is-active"),i.classList.add("is-visible"),g++}),setTimeout(function(){m=!1,u()},400),setTimeout(function(){c(i)},r.fadeOutDelay)}function u(){if(h.length&&g<4){var e=h.shift();l(e.type,{message:e.message,data:e.data})}}function c(e){-1===p.indexOf(e.id)&&(p.push(e.id),requestAnimationFrame(function(){e.classList.remove("is-active")}),setTimeout(function(){requestAnimationFrame(function(){p.splice(p.indexOf(e.id),1),w.removeChild(e),g--,u(),w.children.length||w.classList.remove("is-active")})},500))}function d(e){e.target.classList.contains("notification")&&!e.target.classList.contains("notification-error")&&c(e.target)}if(!(this instanceof n))return new n(r);var f=this,h=[],p=[],g=0,m=!1,v={message:5e3,error:7e3,welcome:7e3},w=e.createEl("div","notifications",r);f.showMessage=a,f.showError=o,f.showWelcome=i}return n}),define("views/workspacenavview",["util/el"],function(e){function t(n){if(!(this instanceof t))return new t(n);var r=this,i=e.createEl("nav","workspace-nav",n);r.el=i}return t}),define("views/aboutview",["util/el","views/dialog","models/localisationmodel","util/localizetext"],function(e,t,n,r){function i(n){if(!(this instanceof i))return new i(n);var a=e.createButton("about.info","about.infotitle","nav-button info-button",n),o=t("about-dialog",n,a),s=e.createEl("div","about-content"),l=document.querySelector(".description");r(l,"innerHTML","index.description"),s.appendChild(l),o.add(s)}return i}),define("views/draganddropview",["util/browser","util/addpublishers"],function(e,t){function n(r){function i(e){e.preventDefault()}function a(e){c||(r.classList.add("drag-over"),c=!0),i(e)}function o(e){c&&(r.classList.remove("drag-over"),c=!1),i(e)}function s(e){i(e),e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files[0]&&u.drop.dispatch(e.dataTransfer.files[0]),r.classList.remove("drag-over")}if(!(this instanceof n))return new n(r);var l=this,u=t(l,"drop"),c=!1;e.test("draganddrop")&&(document.addEventListener("drop",s,!1),document.addEventListener("dragover",a,!1),document.addEventListener("dragleave",o,!1))}return n}),define("views/workspaceview",["util/addpublishers"],function(e){function t(n){if(!(this instanceof t))return new t(n);var r=this,i=e(r,"click"),a=document.createElement("div");a.classList.add("workspace"),n.appendChild(a),a.addEventListener("click",i.click.dispatch,!0),r.el=a}return t}),define("views/welcomeview",["util/addpublishers"],function(e){function t(){function n(){["welcome.firstvisit.0","welcome.firstvisit.1","welcome.firstvisit.2"].forEach(function(e,t){setTimeout(function(){o.message.dispatch(e,18e3)},3e3*t)})}function r(e){}function i(e){s=e}if(!(this instanceof t))return new t;var a=this,o=e(a,"message"),s=0;a.show=n,a.updateVisits=i,a.showLanguageHint=r}return t}),define("views/settingsview",["util/el","views/dialog","util/addpublishers","util/localizetext"],function(e,t,n,r){function i(a){function o(e,t,n){h.el.querySelector("#setting-"+e)||("language"===e?h.add("is-online-only",s(e,t,n)):h.add(s(e,t,n)))}function s(t,n,i){var a,o=e.createEl("div","setting");e.createLabel("settings."+t.toLowerCase(),"setting-"+t,"setting-label",o);if(i){if(Array.isArray(i)){a=e.createEl("select","setting-input setting-select",o);var s;i.forEach(function(i){s=e.createEl("option",null,a),s.value=i,r(s,"textContent","settings."+t+"options."+i),i===n&&(s.selected=!0)})}}else"boolean"==typeof n&&(a=e.createEl("input","setting-input setting-checkbox",o),a.type="checkbox",!0===n&&(a.checked=!0));return a&&(a.id="setting-"+t,a.setAttribute("data-setting",t),a.addEventListener("change",l)),o}function l(e){e.target;if(e.target.classList.contains("setting-input")){var t,n=e.target,r=n.getAttribute("data-setting");n.classList.contains("setting-checkbox")?t=n.checked:n.classList.contains("setting-select")&&(t=n.value),void 0!==t&&d.settingchange.dispatch(r,t)}}function u(e,t,n){cancelAnimationFrame(p[e]),p[e]=requestAnimationFrame(function(){o(e,t,n);var r=h.el.querySelector('.setting-checkbox[data-setting="'+e+'"]');if(r&&(r.classList.contains("setting-checkbox")&&r.checked!==t&&(r.checked=t),r.classList.contains("setting-select")&&r.value!==t))for(var i,a,s=r.querySelector("option"),l=0,u=s.length;l<u;l++)i=s[l],a=i.value,a!==t||i.selected||(i.selected=!0),a!==t&&i.selected&&(i.selected=!1)})}if(!(this instanceof i))return new i(a);var c=this,d=n(c,"settingchange"),f=e.createButton("settings.settings","settings.settingstitle","nav-button settings-button",a),h=t("settings-dialog",a,f),p={};c.settingUpdated=u}return i}),define("views/downloadview",["util/browser","util/el","util/time"],function(e,t,n){function r(e){function i(e,t){t=t||"glitched";var r=t.split("/"),i=r.length>1?r.pop():r[0];i=i.split(".").shift(),date=new Date,fileId=n.dateTimeToLocalStr(date);var a=i+"-glitched-"+fileId+".png";a=a.replace(/(\s|\/|:)/gim,"-"),o.setAttribute("download",a),o.href=e}if(!(this instanceof r))return new r(e);var a=this,o=t.createLink("file.download","file.downloadtitle",null,null,"download-button",e);o.target="_blank",a.updateDownloadLink=i}return r}),define("models/controlsmodel",["util/object","util/addpublishers"],function(e,t){function n(r){function i(t){if(t){t=e.getCopy(t);var n;for(var r in t)limit=c[r],n=t[r],"undefined"!=typeof limit&&"number"==typeof n&&!isNaN(n)&&n>=limit.min&&n<=limit.max&&d[r]!==n&&(d[r]=n,u.update.dispatch(r,d[r]))}return l}function a(e,t){return"number"!=typeof d[e]||"number"!=typeof t||isNaN(t)||(d[e]=t,u.update.dispatch(e,d[e])),l}function o(){var e={};for(var t in c)e[t]=parseInt(Math.random()*(c[t].max-c[t].min)+c[t].min,10);return i(e),l}function s(t){var n={};t=t||d;for(var r in t)"number"==typeof t[r].value?n[r]=t[r].value:n[r]=t[r];return e.getCopy(n)}if(!(this instanceof n))return new n(r);var l=this,u=t(l,["update"]),c=function(t){var n={};for(var r in t)n[r]={min:t[r].min,max:t[r].max};return e.getCopy(n)}(r)||{},d=s(r)||{};l.randomizeValues=o,l.setValue=a,l.getValues=s}return n}),define("util/canvas",[],function(){function e(e,r,i,a){function o(){c&&s.src===e?(t.width=s.naturalWidth,t.height=s.naturalHeight,l=Math.min(r.width/s.naturalWidth,r.height/s.naturalHeight),n.drawImage(s,0,0),s.src=t.toDataURL("image/png",1)):(t.width=r.width,t.height=r.height,n.scale(l,l),n.drawImage(s,0,0),"both"===a?i({dataURL:t.toDataURL("image/png",1),imageData:n.getImageData(0,0,t.width,t.height)}):c||"asDataURL"===a?i(t.toDataURL("image/png",1)):u||"asImageData"===a?i(n.getImageData(0,0,t.width,t.height)):i())}var s=new Image,l=1,u=!1,c=!1;s.addEventListener("load",o),"string"==typeof e&&(c=!0,s.src=e),e.width&&e.height&&e.data&&e.data.length&&(u=!0,t.width=e.width,t.height=e.height,l=Math.min(r.width/e.width,r.height/e.height),n.putImageData(e,0,0),s.src=t.toDataURL("image/png",1)),c||u||i(!1)}var t=document.createElement("canvas"),n=t.getContext("2d");return{resizeImage:e}}),define("models/imagemodel",["util/browser","util/addpublishers","util/time","util/canvas","util/localizetext"],function(e,t,n,r,i){function a(){function o(e){return A&&(L=e.name,b.readAsDataURL(e)),E}function s(e){return u(),k.width=e.width||e.videoWidth||e.clientWidth,k.height=e.height||e.videoHeight||e.clientHeight,S.translate(k.width,0),S.scale(-1,1),S.drawImage(e,0,0),y=k.toDataURL("image/png"),L=i("webcam.picture",n.dateTimeToLocalStr(new Date)),p(S.getImageData(0,0,k.width,k.height),x.load.dispatch),E}function l(e,t){return t&&(L=t),e=decodeURIComponent(e),x.update.dispatch("img",e,t),e&&I.src!==e?(I.src="",y=e,I.src=e):c(),E}function u(){S.clearRect(0,0,k.width,k.height)}function c(){p(m(I),x.load.dispatch)}function d(e){x.error.dispatch("file.error.openimage",I.src)}function f(e){l(e.target.result)}function h(e){x.error.dispatch("file.error.openfile")}function p(e,t){if(T&&e.data&&e.data.length/4>_){var n=e.width/e.height,i=e.height/e.width,a=Math.round(Math.sqrt(_/n)),o=Math.round(a*i),s={width:a,height:o};x.statusmessage.dispatch("file.message.resize"),r.resizeImage(e,s,function(e){t(e.imageData),"string"==typeof e.dataURL&&(y=e.dataURL)},"both")}else t(e)}function g(e,t){"resizeUploadedImages"===e&&"boolean"==typeof t&&(T=t)}function m(e){return u(),k.width=e.naturalWidth,k.height=e.naturalHeight,S.drawImage(e,0,0,e.naturalWidth,e.naturalHeight),S.getImageData(0,0,e.naturalWidth,e.naturalHeight)}function v(e){return y}function w(e){return L}if(!(this instanceof a))return new a;var b,y,L,E=this,x=t(E,["load","update","error","statusmessage"]),k=document.createElement("canvas"),S=k.getContext("2d"),I=new Image,A=!1,_=.8*Math.pow(1e3,2),T=!0;(b=e.getFeature(window,"FileReader"))&&(b=new b,A=!0,b.addEventListener("load",f),b.addEventListener("error",h)),I.addEventListener("load",c),I.addEventListener("error",d),E.loadFromFile=o,E.loadFromVideo=s,E.getLastImageSRC=v,E.getLastFileName=w,E.loadFromURL=l,E.settingUpdated=g}return a}),function(e,t){"function"==typeof define&&define.amd?define("lib/glitch-canvas-with-worker",t):"object"==typeof exports?module.exports=t():e.glitch=t()}(this,function(){function e(t){function n(){return t&&"Worker"in window?(k=new Worker(t),k.addEventListener("message",i,!1)):(S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=S.split(""),A={},I.forEach(function(e,t){A[e]=t})),C}function r(e,t,n){if(u(e)&&c(t,"parameters","object")&&c(n,"callback","function"))if(o(D,e),o(R,e),x=s(t),w=l(e,x.quality),b.onload=function(){O.drawImage(b,0,0),y=O.getImageData(0,0,e.width,e.height),n(y),b.onload=null},k)k.postMessage({glitch:{base64:w,parameters:x}});else{for(_=g(w),T=v(_),L=0,E=x.iterations;L<E;L++)p(_,T,x.seed,x.amount,L,x.iterations);b.src=m(_)}return C}function i(e){e&&e.data&&e.data.glitched?a(e.data.glitched):window.console&&console.log("glitchworker response",e.data)}function a(e){b.src=e}function o(e,t){e.width!==t.width&&(e.width=t.width),e.height!==t.height&&(e.height=t.height)}function s(e){return{seed:(e.seed||0)/100,quality:(e.quality||0)/100,amount:(e.amount||0)/100,iterations:e.iterations||0}}function l(e,t){var n="number"==typeof t&&t<1&&t>0?t:.1;q.putImageData(e,0,0);var r=R.toDataURL("image/jpeg",n);switch(r.length%4){case 3:r+="=";break;case 2:r+="==";break;case 1:r+="==="}return r}function u(e){return!!(c(e,"imageData","object")&&c(e.width,"imageData.width","number")&&c(e.height,"imageData.height","number")&&c(e.data,"imageData.data","object")&&c(e.data.length,"imageData.data.length","number")&&d(e.data.length,"imageData.data.length",f,"> 0"))}function c(e,t,n){return typeof e===n||(h(e,"typeof "+t,'"'+n+'"','"'+typeof e+'"'),!1)}function d(e,t,n,r){if(!0===n(e))return!0;h(e,t,r,"not")}function f(e){return e>0}function h(e,t,n,r){throw new Error("glitch(): Expected "+t+" to be "+n+", but it was "+r+".")}function p(e,t,n,r,i,a){var o=e.length-t-4,s=parseInt(o/a*i,10),l=parseInt(o/a*(i+1),10),u=l-s,c=parseInt(s+u*n,10);c>o&&(c=o),e[Math.floor(t+c)]=Math.floor(256*r)}function g(e){var t,n,r=[];for(L=23,E=e.length;L<E;L++){switch(t=A[e.charAt(L)],(L-23)%4){case 1:r.push(n<<2|t>>4);break;case 2:r.push((15&n)<<4|t>>2);break;case 3:r.push((3&n)<<6|t)}n=t}return r}function m(e){var t,n,r,i=["data:image/jpeg;base64,"];for(L=0,E=e.length;L<E;L++){switch(n=e[L],t=L%3){case 0:i.push(I[n>>2]);break;case 1:i.push(I[(3&r)<<4|n>>4]);break;case 2:i.push(I[(15&r)<<2|n>>6]),i.push(I[63&n])}r=n}return 0===t?(i.push(I[(3&r)<<4]),i.push("==")):1===t&&(i.push(I[(15&r)<<2]),i.push("=")),i.join("")}function v(e){var t=417;for(L=0,E=e.length;L<E;L++)if(255===e[L]&&218===e[L+1]){t=L+2;break}return t}if(!(this instanceof e))return new e(t);var w,b,y,L,E,x,k,S,I,A,_,T,C=this,D=document.createElement("canvas"),R=document.createElement("canvas"),O=D.getContext("2d"),q=R.getContext("2d"),b=new Image;C.glitch=r,C.init=n}return e}),define("models/glitchmodel",["config","lib/glitch-canvas-with-worker","util/addpublishers","util/canvas"],function(e,t,n,r){function i(){function a(){g&&d&&v.glitch(d,g,o)}function o(e){f=e,p.glitch.dispatch(e)}function s(e,t){g[e]!==t&&(g[e]=t,m=setTimeout(a,10))}function l(e){d=e,a()}function u(e,t,n){return d&&(t=t||{width:50,height:50},"string"==typeof t&&"original"===t&&(t={width:f.width,height:f.height}),r.resizeImage(f,t,function(t){n=Array.prototype.slice.call(n||[]),n.unshift(t),e.apply(e,n)},"asDataURL")),h}function c(e,t){return function(){u(e,t,arguments)}}if(!(this instanceof i))return new i;var d,f,h=this,p=n(h,"glitch"),g={},m=(document.createElement("canvas"),new Image,NaN),v=t(e.workers.glitch).init();h.setValue=s,h.setImageData=l,h.generateImageURL=u,h.getImageGenerationFn=c}return i}),function(e){"use strict";function t(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function n(e,t){return e<<t|e>>>32-t}function r(e,r,i,a,o,s){return t(n(t(t(r,e),t(a,s)),o),i)}function i(e,t,n,i,a,o,s){return r(t&n|~t&i,e,t,a,o,s)}function a(e,t,n,i,a,o,s){return r(t&i|n&~i,e,t,a,o,s)}function o(e,t,n,i,a,o,s){return r(t^n^i,e,t,a,o,s)}function s(e,t,n,i,a,o,s){return r(n^(t|~i),e,t,a,o,s)}function l(e,n){e[n>>5]|=128<<n%32,e[14+(n+64>>>9<<4)]=n;var r,l,u,c,d,f=1732584193,h=-271733879,p=-1732584194,g=271733878;for(r=0;r<e.length;r+=16)l=f,u=h,c=p,d=g,f=i(f,h,p,g,e[r],7,-680876936),g=i(g,f,h,p,e[r+1],12,-389564586),p=i(p,g,f,h,e[r+2],17,606105819),h=i(h,p,g,f,e[r+3],22,-1044525330),f=i(f,h,p,g,e[r+4],7,-176418897),g=i(g,f,h,p,e[r+5],12,1200080426),p=i(p,g,f,h,e[r+6],17,-1473231341),h=i(h,p,g,f,e[r+7],22,-45705983),f=i(f,h,p,g,e[r+8],7,1770035416),g=i(g,f,h,p,e[r+9],12,-1958414417),p=i(p,g,f,h,e[r+10],17,-42063),h=i(h,p,g,f,e[r+11],22,-1990404162),f=i(f,h,p,g,e[r+12],7,1804603682),g=i(g,f,h,p,e[r+13],12,-40341101),p=i(p,g,f,h,e[r+14],17,-1502002290),h=i(h,p,g,f,e[r+15],22,1236535329),f=a(f,h,p,g,e[r+1],5,-165796510),g=a(g,f,h,p,e[r+6],9,-1069501632),p=a(p,g,f,h,e[r+11],14,643717713),h=a(h,p,g,f,e[r],20,-373897302),f=a(f,h,p,g,e[r+5],5,-701558691),g=a(g,f,h,p,e[r+10],9,38016083),p=a(p,g,f,h,e[r+15],14,-660478335),h=a(h,p,g,f,e[r+4],20,-405537848),f=a(f,h,p,g,e[r+9],5,568446438),g=a(g,f,h,p,e[r+14],9,-1019803690),p=a(p,g,f,h,e[r+3],14,-187363961),h=a(h,p,g,f,e[r+8],20,1163531501),f=a(f,h,p,g,e[r+13],5,-1444681467),g=a(g,f,h,p,e[r+2],9,-51403784),p=a(p,g,f,h,e[r+7],14,1735328473),h=a(h,p,g,f,e[r+12],20,-1926607734),f=o(f,h,p,g,e[r+5],4,-378558),g=o(g,f,h,p,e[r+8],11,-2022574463),p=o(p,g,f,h,e[r+11],16,1839030562),h=o(h,p,g,f,e[r+14],23,-35309556),f=o(f,h,p,g,e[r+1],4,-1530992060),g=o(g,f,h,p,e[r+4],11,1272893353),p=o(p,g,f,h,e[r+7],16,-155497632),h=o(h,p,g,f,e[r+10],23,-1094730640),f=o(f,h,p,g,e[r+13],4,681279174),g=o(g,f,h,p,e[r],11,-358537222),p=o(p,g,f,h,e[r+3],16,-722521979),h=o(h,p,g,f,e[r+6],23,76029189),f=o(f,h,p,g,e[r+9],4,-640364487),g=o(g,f,h,p,e[r+12],11,-421815835),p=o(p,g,f,h,e[r+15],16,530742520),h=o(h,p,g,f,e[r+2],23,-995338651),f=s(f,h,p,g,e[r],6,-198630844),g=s(g,f,h,p,e[r+7],10,1126891415),p=s(p,g,f,h,e[r+14],15,-1416354905),h=s(h,p,g,f,e[r+5],21,-57434055),f=s(f,h,p,g,e[r+12],6,1700485571),g=s(g,f,h,p,e[r+3],10,-1894986606),p=s(p,g,f,h,e[r+10],15,-1051523),h=s(h,p,g,f,e[r+1],21,-2054922799),f=s(f,h,p,g,e[r+8],6,1873313359),g=s(g,f,h,p,e[r+15],10,-30611744),p=s(p,g,f,h,e[r+6],15,-1560198380),h=s(h,p,g,f,e[r+13],21,1309151649),f=s(f,h,p,g,e[r+4],6,-145523070),g=s(g,f,h,p,e[r+11],10,-1120210379),p=s(p,g,f,h,e[r+2],15,718787259),h=s(h,p,g,f,e[r+9],21,-343485551),f=t(f,l),h=t(h,u),p=t(p,c),g=t(g,d);return[f,h,p,g]}function u(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function c(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function d(e){return u(l(c(e),8*e.length))}function f(e,t){var n,r,i=c(e),a=[],o=[];for(a[15]=o[15]=void 0,i.length>16&&(i=l(i,8*e.length)),n=0;n<16;n+=1)a[n]=909522486^i[n],o[n]=1549556828^i[n];return r=l(a.concat(c(t)),512+8*t.length),u(l(o.concat(r),640))}function h(e){var t,n,r="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}function p(e){return unescape(encodeURIComponent(e))}function g(e){return d(p(e))}function m(e){return h(g(e))}function v(e,t){return f(p(e),p(t))}function w(e,t){return h(v(e,t))}function b(e,t,n){return t?n?v(t,e):w(t,e):n?g(e):m(e)}"function"==typeof define&&define.amd?define("lib/md5",[],function(){return b}):e.md5=b}(this),define("models/storagemodel",["config","util/browser","util/addpublishers","lib/md5","lib/localforage.nopromises","models/localisationmodel"],function(e,t,n,r,i,a){function o(){function a(e){if(E&&e)if(v)p("add",e);else{var t=g(e);L[t]&&L[t].deleteHash===e.deleteHash&&L[t].publicUrl===e.publicUrl&&L[t].imgurID===e.imgurID?k.statusmessage.dispatch("file.message.before"):(e.timestamp=Date.now(),L[t]=e,d(function(){k.statusmessage.dispatch("file.message.save")}))}return w}function s(e){E&&e&&(v?p("removeCompletely",e):L[e]&&(L[e].deleteHash||L[e].publicUrl||L[e].imgurID||L[e].values||L[e].src)?console&&console.log("cant delete storage item because theres still some data left",L[e]):(k.removeall.dispatch(L[e]),delete L[e],d(function(){k.statusmessage.dispatch("file.message.del")})))}function l(e){return E&&e&&(v?p("removeLocalData",e):L[e]&&(L[e].src&&(delete L[e].src,k.removelocaldata.dispatch(L[e])),L[e].values&&delete L[e].values,L[e].deleteHash||L[e].publicUrl||L[e].imgurID||s(e),d())),w}function u(e){return E&&e&&(v?p("removeImgurData",e):L[e]&&(L[e].deleteHash&&(k.removeimgurdata.dispatch(L[e]),delete L[e].deleteHash),L[e].publicUrl&&delete L[e].publicUrl,L[e].imgurID&&delete L[e].imgurID,L[e].src||L[e].values||s(e),d())),w}function c(e){return E&&(v?p("load"):i.getItem(S,function(t,n){t?(k.error.dispatch("file.error.load"),console&&console.log("localforage error",t)):(L=n&&n.entries?n.entries:{},k.update.dispatch(L),y=n&&n.visitCount?n.visitCount:1,b=!n||!n.lastVisit,b&&k.firstvisit.dispatch(),d(),y&&k.visits.dispatch(y),"function"==typeof e&&e())})),w}function d(e){return E&&(v?p("save"):i.setItem(S,{entries:L,lastVisit:Date.now(),visitCount:y+1},function(t,n){t?(k.error.dispatch("file.error.save"),console&&console.log("localforage error",t)):n?(L=n.entries,k.update.dispatch(L),k.save.dispatch(),"function"==typeof e&&e()):console&&console.log("no data was saved",n)})),w}function f(e){return E&&(v?p("loadItem",e):L[e]&&k.loaditem.dispatch(e,L[e])),w}function h(e){e&&e.data&&x.forEach(function(t){void 0!==e.data[t]&&("loaditem"===t?k[t].dispatch(e.data[t].uid,e.data[t].entries):k[t]===t?k[t].dispatch():k[t].dispatch(e.data[t]))})}function p(e,t){if("string"==typeof e){void 0===t&&(t=e);var n={};n[e]=t,v.postMessage(n)}}function g(e){var t="N"+e.name+"S"+e.src+"L"+e.thumbnail.length||"0V";for(var n in e.values)t+=n.substr(0,2),t+=e.values[n];return r(t)}function m(){var e,t,n;for(var r in L)(n=L[r].timestamp)&&(!e||n>t)&&(e=r,t=n);return e}if(!(this instanceof o))return new o;var v,w=this,b=!1,y=0,L={},E=t.test("localforage")&&i,x=["update","save","loaditem","removeall","removelocaldata","removeimgurdata","visits","firstvisit","error","statusmessage"],k=n(w,x),S=e.keys.storage;E&&t.test("webworker")&&t.test("browserdb")&&!t.test("safari")&&(v=new Worker(e.workers.storage),v.addEventListener("message",h,!1),p("setStorageKey",S)),w.add=a,w.removeImgurData=u,w.removeLocalData=l,w.load=c,w.loadItem=f,w.removeImgurData=u,w.getLatestUID=m}return o}),define("models/sharemodel",["config","lib/reqwest","util/addpublishers"],function(e,t,n){function r(){function i(){return d?(h.uploadstart.dispatch(),t({url:"https://api.imgur.com/3/image.json",method:"POST",headers:{Authorization:"Client-ID "+e.keys.imgur},data:{image:d.split(",")[1],type:"base64"},type:"json",crossOrigin:!0,success:a,error:o})):o(new Error("share.error.base64")),f}function a(e){if(h.uploadend.dispatch(),200===e.status&&e.data&&e.data.link){var t=e.data.link.replace("http://","https://");h.uploadcomplete.dispatch(t,e.data.id,e.data.deletehash),h.statusmessage.dispatch("share.message.upload",{innerHTML:!0,args:[t]})}}function o(e){h.uploadend.dispatch(),h.error.dispatch("share.error.upload",{type:"imguruploadfail"}),console&&console.log(e.message||e)}function s(e){return d=e,f}function l(n,r){return r&&(h.removestart.dispatch(n),t({url:"https://api.imgur.com/3/image/"+r,method:"DELETE",headers:{Authorization:"Client-ID "+e.keys.imgur},crossOrigin:!0,success:function(){u(n)},error:function(e){c(n,e)}})),f}function u(e){h.removeend.dispatch(e),h.removecomplete.dispatch(e),h.statusmessage.dispatch("share.message.del")}function c(e,t){h.removeend.dispatch(e),h.error.dispatch("share.error.del",{type:"imgurremovefail",uid:e}),console&&console.log(t.message||t)}if(!(this instanceof r))return new r;var d,f=this,h=n(f,"uploadstart","uploadend","uploadcomplete","removestart","removeend","removecomplete","error","statusmessage");f.upload=i,f.updateUrl=s,f.remove=l}return r}),define("models/networkmodel",["util/addpublishers"],function(e){function t(){function n(){return navigator.onLine!==r&&(r=navigator.onLine,a.connectivitychange.dispatch(r),r?a.connect.dispatch():a.disconnect.dispatch()),i}if(!(this instanceof t))return new t;var r,i=this,a=e(i,"connectivitychange","disconnect","connect");window.addEventListener("online",n),window.addEventListener("offline",n),i.checkConnectivity=n}return t}),define("models/settingsmodel",["config","util/browser","util/object","util/addpublishers","lib/localforage.nopromises"],function(e,t,n,r,i){function a(){function o(e){return E[e]}function s(e){var t=o(e);return t?t.value:void 0}function l(){return n.getCopy(E)}function u(e,t){var n=!1;return"string"==typeof e&&void 0!==E[e]&&typeof t==typeof E[e].value&&t!==E[e].value&&(E[e].value=t,n=!0),n&&(y?c(E):p(E)),v}function c(t){y&&(t=g(t),m?f("save",t):i.setItem(e.keys.settings,t,function(e,t){e?(sendError("settings.error.save"),console&&console.log("localforage error",e)):t?p(t):console&&console.log("no data was saved",t)}))}function d(){y?m?f("load"):i.getItem(e.keys.settings,function(e,t){e?(sendError("settings.error.load"),console&&console.log("localforage error",e)):p(t)}):p(E||L)}function f(e,t){if("string"==typeof e){void 0===t&&(t=e);var n={};n[e]=t,m.postMessage(n)}}function h(e){e&&e.data&&w.forEach(function(t){void 0!==e.data[t]&&("update"===t?p(e.data[t]):b[t]===t?b[t].dispatch():b[t].dispatch(e.data[t]))})}function p(e){if(e)if(E=e||L,n.isEqual(g(E),E))for(var t in E)b.update.dispatch(t,E[t].value,E[t].options);else c(g(E));else E=L,c(E)}function g(e){return e&&L&&e!==L&&(e=n.merge(e,L)),e}if(!(this instanceof a))return new a;var m,v=this,w=["update","error"],b=r(v,w),y=t.test("localforage")&&i,L=e.settings,E=((navigator.language||navigator.userLanguage||"").toLowerCase(),{});y&&t.test("webworker")&&t.test("browserdb")&&!t.test("safari")?(m=new Worker(e.workers.settings),m.addEventListener("message",h,!1),f("setStorageKey",e.keys.settings),f("setDefaultSettings",L)):p(L),v.getSetting=o,v.getSettingValue=s,v.getSettings=l,v.setValue=u,v.load=d}return a}),requirejs.config({baseUrl:"scripts/",waitSeconds:10}),require(["config","util/browser","views/appview","views/navview","views/controlsview","views/openfileview","views/fullscreenview","views/webcamview","views/canvasview","views/canvascontrolsview","views/saveview","views/shareview","views/indicatorview","views/workspacenavview","views/aboutview","views/draganddropview","views/workspaceview","views/welcomeview","views/settingsview","views/downloadview","models/controlsmodel","models/imagemodel","models/glitchmodel","models/storagemodel","models/sharemodel","models/networkmodel","models/settingsmodel","models/localisationmodel","lib/localforage.nopromises"],function(e,t,n,r,i,a,o,s,l,u,c,d,f,h,p,g,m,v,w,b,y,L,E,x,k,S,I,A,_){function T(){Z.on("update",z.setValue).on("random",z.randomizeValues),z.on("update",Z.setValue).on("update",H.setValue).on("update",re.hideShareLinks),J.on("center",$.animateToCenter).on("scale",$.setScale),$.on("scale",J.setScale).on("dblclick",$.animateToCenter),ee.on("openfile",F.loadFromFile).on("openfromlocalstorage",B.loadItem).on("deletefromlocalstorage",B.removeLocalData).on("deletefromimgur",U.remove),te.on("savetolocalstorage",H.getImageGenerationFn(O)).on("savetolocalstorage",N).on("show",N),G.on("toggleend",$.resized),
F.on("load",H.setImageData).on("load",ee.dialog.hide).on("load",$.animateToCenter).on("load",$.show).on("update",$.hide).on("error",K.showError).on("error",K.hideLoading).on("statusmessage",K.showMessage),H.on("glitch",$.putImageData).on("glitch",$.createImageUrl(U.updateUrl)).on("glitch",N),re.on("share",U.upload).on("deletefromimgur",U.remove),U.on("uploadstart",re.showUpload).on("uploadend",re.hideUpload).on("uploadcomplete",re.uploadComplete).on("uploadcomplete",H.getImageGenerationFn(O)).on("removecomplete",B.removeImgurData).on("removecomplete",re.hideShareLinks).on("error",K.showError).on("error",re.handleError).on("statusmessage",K.showMessage),ne.on("video",F.loadFromVideo).on("error",K.showError),oe.on("drop",F.loadFromFile).on("drop",$.hide),se.on("message",K.showWelcome),Q.on("click",G.closeSmallScreenNav),ie.on("settingchange",V.setValue),B.on("update",ee.updateList).on("update",re.updateList).on("update",R).on("loaditem",q).on("statusmessage",K.showMessage).on("error",K.showError).on("visits",se.updateVisits).on("firstvisit",se.show),P.on("connect",re.showOnlineOptions).on("disconnect",re.hideOnlineOptions).on("connect",X.showOnlineOptions).on("disconnect",X.hideOnlineOptions),V.on("update",$.panZoom.settingUpdated).on("update",F.settingUpdated).on("update",ie.settingUpdated).on("update",W.settingUpdated).on("error",K.showError),W.on("error",K.showError).on("error",j).on("newlanguage",se.showLanguageHint).on("update",j)}function C(){t.test("touch")&&document.documentElement.classList.add("has-touch")}function D(n){if(_){_.config(e.localForage);var r=[_.INDEXEDDB,_.WEBSQL,_.LOCALSTORAGE];t.test("safari")&&(r=_.LOCALSTORAGE),_.setDriver(r).then(n)}else"function"==typeof n&&n()}function R(t){var n=-1;if(t&&Object.keys(t).length){var r=Date.now(),i=1/0;for(var a in t)t[a].timestamp&&r-t[a].timestamp<i&&(i=r-t[a].timestamp,n=a)}B.off("update",R),-1!==n?B.loadItem(n):(F.loadFromURL(e.defaultImage.path,e.defaultImage.name),Z.loadInitialValues())}function O(e,t,n,r){var i={thumbnail:e,src:F.getLastImageSRC(),values:z.getValues(),name:F.getLastFileName()};t&&(i.publicUrl=t),n&&(i.imgurID=n),r&&(i.deleteHash=r),B.add(i)}function q(e,t){for(var n in t.values)z.setValue(n,t.values[n]);F.loadFromURL(t.src,t.name)}function N(){clearTimeout(le),le=setTimeout(function(){H.getImageGenerationFn(te.updateDownloadLink,"original")(F.getLastFileName()),H.getImageGenerationFn(ae.updateDownloadLink,"original")(F.getLastFileName())},200)}function j(){M||requestAnimationFrame(function(){M=!0,document.documentElement.classList.add("is-loaded"),setTimeout(function(){document.documentElement.classList.remove("is-loading")},10)})}var M=!1,F=L(),H=E(),U=k(),B=x(),z=y(e.defaultControlParams),P=S(),W=A.sharedInstance,V=I(),X=n(document.body),G=r(X.el),Q=m(X.el),Y=h(Q.el),J=u(Y.el),Z=i(Y.el,J.el,e.defaultControlParams),K=f(Q.el),$=l(Q.el,G.el),ee=a(G.el),te=c(G.el),ne=s(G.el),re=d(G.el),ie=w(G.el),ae=(p(G.el),o(Q.el),b(Q.el)),oe=g($.el),se=v(),le=NaN;!function(){C(),T(),P.checkConnectivity(),t.test("localforage")&&_?D(function(){B.load(),V.load(),R()}):(V.load(),Z.loadInitialValues(),R())}()}),define("glitcher",function(){})}();